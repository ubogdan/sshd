(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ce7f546"],{"12f3":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{staticStyle:{height:"100vh",width:"100%"}},[n("div",{ref:"viewport",staticClass:"viewport"},[n("div",{ref:"display",staticClass:"display",attrs:{tabindex:"0"}})])])},o=[];n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("fb6a"),n("b0c0"),n("a630");function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){if(e){if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function s(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,i=e},f:function(){try{s||null==n["return"]||n["return"]()}finally{if(u)throw i}}}}n("a15b");var u=n("a9c6"),c=n.n(u),l=function(e){var t=this;this.touchMouseThreshold=3,this.scrollThreshold=53,this.PIXELS_PER_LINE=18,this.PIXELS_PER_PAGE=16*this.PIXELS_PER_LINE,this.currentState=new c.a.Mouse.State(0,0,!1,!1,!1,!1,!1),this.onmousedown=null,this.onmouseup=null,this.onmousemove=null,this.onmouseout=null;var n=0,r=0;function o(e){e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function i(){n=t.touchMouseThreshold}function a(e){var n=e.deltaY||-e.wheelDeltaY||-e.wheelDelta;if(n?1===e.deltaMode?n=e.deltaY*t.PIXELS_PER_LINE:2===e.deltaMode&&(n=e.deltaY*t.PIXELS_PER_PAGE):n=e.detail*t.PIXELS_PER_LINE,r+=n,r<=-t.scrollThreshold){do{t.onmousedown&&(t.currentState.up=!0,t.onmousedown(t.currentState)),t.onmouseup&&(t.currentState.up=!1,t.onmouseup(t.currentState)),r+=t.scrollThreshold}while(r<=-t.scrollThreshold);r=0}if(r>=t.scrollThreshold){do{t.onmousedown&&(t.currentState.down=!0,t.onmousedown(t.currentState)),t.onmouseup&&(t.currentState.down=!1,t.onmouseup(t.currentState)),r-=t.scrollThreshold}while(r>=t.scrollThreshold);r=0}o(e)}e.addEventListener("contextmenu",(function(e){o(e)}),!1),e.addEventListener("mousemove",(function(r){n?n--:(t.currentState.fromClientPosition(e,r.clientX,r.clientY),t.onmousemove&&t.onmousemove(t.currentState))}),!1),e.addEventListener("mousedown",(function(e){if(o(e),!n){switch(e.button){case 0:t.currentState.left=!0;break;case 1:t.currentState.middle=!0;break;case 2:t.currentState.right=!0;break}t.onmousedown&&t.onmousedown(t.currentState)}}),!1),e.addEventListener("mouseup",(function(e){if(o(e),!n){switch(e.button){case 0:t.currentState.left=!1;break;case 1:t.currentState.middle=!1;break;case 2:t.currentState.right=!1;break}t.onmouseup&&t.onmouseup(t.currentState)}}),!1),e.addEventListener("mouseout",(function(n){n||(n=window.event);var r=n.relatedTarget||n.toElement;while(r){if(r===e)return;r=r.parentNode}o(n),(t.currentState.left||t.currentState.middle||t.currentState.right)&&(t.currentState.left=!1,t.currentState.middle=!1,t.currentState.right=!1,t.onmouseup&&t.onmouseup(t.currentState)),t.onmouseout&&t.onmouseout()}),!1),e.addEventListener("selectstart",(function(e){o(e)}),!1),e.addEventListener("touchmove",i,!1),e.addEventListener("touchstart",i,!1),e.addEventListener("touchend",i,!1),e.addEventListener("DOMMouseScroll",a,!1),e.addEventListener("mousewheel",a,!1),e.addEventListener("wheel",a,!1);var s=function(){var e=document.createElement("div");if(!("cursor"in e.style))return!1;try{e.style.cursor="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX///+nxBvIAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==) 0 0, auto"}catch(t){return!1}return/\burl\([^()]*\)\s+0\s+0\b/.test(e.style.cursor||"")}();this.setCursor=function(t,n,r){if(s){var o=t.toDataURL("image/png");return e.style.cursor="url("+o+") "+n+" "+r+", auto",!0}return!1}};l.State=c.a.Mouse.State,l.Touchpad=c.a.Mouse.Touchpad,l.Touchscreen=c.a.Mouse.Touchscreen;var d={mouse:l},h={IDLE:"IDLE",CONNECTING:"CONNECTING",WAITING:"WAITING",CONNECTED:"CONNECTED",DISCONNECTED:"DISCONNECTED",CLIENT_ERROR:"CLIENT_ERROR",TUNNEL_ERROR:"TUNNEL_ERROR"};function f(e,t,n,r,o,i,a){try{var s=e[i](a),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,o)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,s,"next",e)}function s(e){f(i,r,o,a,s,"throw",e)}a(void 0)}))}}n("ac1f"),n("96cf");var v={install:function(e){v.getLocalClipboard().then((function(e){return v.cache=e})),window.addEventListener("load",v.update(e),!0),window.addEventListener("copy",v.update(e)),window.addEventListener("cut",v.update(e)),window.addEventListener("focus",(function(t){t.target===window&&v.update(e)()}),!0)},update:function(e){return function(){v.getLocalClipboard().then((function(t){v.cache=t,v.setRemoteClipboard(e)}))}},setRemoteClipboard:function(e){if(v.cache){var t,n=e.createClipboardStream(v.cache.type);"string"===typeof v.cache.data?(t=new c.a.StringWriter(n),t.sendText(v.cache.data),t.sendEnd()):(t=new c.a.BlobWriter(n),t.oncomplete=function(){t.sendEnd()},t.sendBlob(v.cache.data))}}};v.getLocalClipboard=p(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!navigator.clipboard||!navigator.clipboard.readText){e.next=5;break}return e.next=3,navigator.clipboard.readText();case 3:return t=e.sent,e.abrupt("return",{type:"text/plain",data:t});case 5:case"end":return e.stop()}}),e)}))),v.setLocalClipboard=function(){var e=p(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!navigator.clipboard||!navigator.clipboard.writeText){e.next=4;break}if("text/plain"!==t.type){e.next=4;break}return e.next=4,navigator.clipboard.writeText(t.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v.onClipboard=function(e,t){var n;if(/^text\//.exec(t)){n=new c.a.StringReader(e);var r="";n.ontext=function(e){r+=e},n.onend=function(){v.setLocalClipboard({type:t,data:r})}}else n=new c.a.BlobReader(e,t),n.onend=function(){v.setLocalClipboard({type:t,data:n.getBlob()})}};var y=v;function g(e){var t=[];for(var n in e)e[n]&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}c.a.Mouse=d.mouse;var m={props:{token:String},name:"Guacamole",data:function(){return{demo:"win",connected:!1,display:null,currentAdjustedHeight:null,client:null,keyboard:null,mouse:null,lastEvent:null,connectionState:h.IDLE,errorMessage:"",arguments:{},query:{token:this.token,screen_width:1024,screen_height:768}}},computed:{wsUrl:function(){var e,t=window.location;return e="https:"===t.protocol?"wss:":"ws:",e+="//"+t.host,e+="/api/ws/guacamole","".concat(e)}},watch:{connectionState:function(e){this.$notify({title:e,type:"success"})}},methods:{doGuacdConnect:function(){window.document.title="RemoteDesktop",this._setScreenSize(),this.startGuacamole()},send:function(e){if(this.client){var t,n=s(e.data);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.client.sendKeyEvent(1,r.charCodeAt(0))}}catch(o){n.e(o)}finally{n.f()}}},copy:function(e){this.client&&(y.cache={type:"text/plain",data:e.data},y.setRemoteClipboard(this.client))},handleMouseState:function(e){var t=Object.assign({},e,{x:e.x/this.display.getScale(),y:e.y/this.display.getScale()});this.client.sendMouseState(t)},_setScreenSize:function(){var e=this.$refs.viewport;if(e&&e.offsetWidth){var t=window.devicePixelRatio||1,n=e.clientWidth*t,r=e.clientHeight*t;this.query.screen_height=r,this.query.screen_width=n}},resize:function(){var e=this,t=this.$refs.viewport;if(t&&t.offsetWidth){var n=window.devicePixelRatio||1,r=t.clientWidth*n,o=t.clientHeight*n;this.display.getWidth()===r&&this.display.getHeight()===o||this.client.sendSize(r,o),setTimeout((function(){var n=Math.min(t.clientWidth/Math.max(e.display.getWidth(),1),t.clientHeight/Math.max(e.display.getHeight(),1));e.display.scale(n)}),100)}},startGuacamole:function(){var e=this,t=new c.a.WebSocketTunnel(this.wsUrl);this.client&&(this.display.scale(0),this.uninstallKeyboard()),this.client=new c.a.Client(t),y.install(this.client),t.onerror=function(t){console.error("Tunnel failed ".concat(JSON.stringify(t))),e.connectionState=h.TUNNEL_ERROR},t.onstatechange=function(t){switch(t){case c.a.Tunnel.State.CONNECTING:e.connectionState=h.CONNECTING;break;case c.a.Tunnel.State.OPEN:e.connectionState=h.CONNECTED;break;case c.a.Tunnel.State.UNSTABLE:break;case c.a.Tunnel.State.CLOSED:e.connectionState=h.DISCONNECTED;break}},this.client.onstatechange=function(t){switch(t){case 0:e.connectionState=h.IDLE;break;case 1:break;case 2:e.connectionState=h.WAITING;break;case 3:e.connectionState=h.CONNECTED,window.addEventListener("resize",e.resize),e.$refs.viewport.addEventListener("mouseenter",e.resize),y.setRemoteClipboard(e.client);case 4:case 5:break}},this.client.onerror=function(t){e.client.disconnect(),e.$message.error("Client error ".concat(JSON.stringify(t))),e.errorMessage=t.message,e.connectionState=h.CLIENT_ERROR},this.client.onsync=function(){},this.client.onargv=function(t,n,r){if("text/plain"===n){var o=new c.a.StringReader(t),i="";o.ontext=function(e){i+=e},o.onend=function(){var t=e.client.createArgumentValueStream("text/plain",r);t.onack=function(t){t.isError()||(e.arguments[r]=i)}}}},this.client.onclipboard=y.onClipboard,this.display=this.client.getDisplay();var n=this.$refs.display;n.appendChild(this.display.getElement()),n.addEventListener("contextmenu",(function(e){e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}));var r=g(this.query);this.client.connect(r),window.onunload=function(){return e.client.disconnect()},this.mouse=new c.a.Mouse(n),this.mouse.onmouseout=function(){e.display&&e.display.showCursor(!1)},n.onclick=function(){n.focus()},n.onfocus=function(){n.className="focus"},n.onblur=function(){n.className=""},this.keyboard=new c.a.Keyboard(n),this.installKeyboard(),this.mouse.onmousedown=this.mouse.onmouseup=this.mouse.onmousemove=this.handleMouseState,setTimeout((function(){e.resize(),n.focus()}),1e3)},installKeyboard:function(){var e=this;this.keyboard.onkeydown=function(t){e.client.sendKeyEvent(1,t)},this.keyboard.onkeyup=function(t){e.client.sendKeyEvent(0,t)}},uninstallKeyboard:function(){this.keyboard.onkeydown=this.keyboard.onkeyup=function(){}}},beforeUpdate:function(){window.document.title="RemoteDesktop"},mounted:function(){this._setScreenSize(),this.doGuacdConnect()}},w=m,S=(n("dd30"),n("2877")),b=Object(S["a"])(w,r,o,!1,null,"4baf442b",null);t["default"]=b.exports},"1dde":function(e,t,n){var r=n("d039"),o=n("b622"),i=n("2d00"),a=o("species");e.exports=function(e){return i>=51||!r((function(){var t=[],n=t.constructor={};return n[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"3d6c":function(e,t,n){},"4df4":function(e,t,n){"use strict";var r=n("0366"),o=n("7b0b"),i=n("9bdd"),a=n("e95a"),s=n("50c4"),u=n("8418"),c=n("35a1");e.exports=function(e){var t,n,l,d,h,f,p=o(e),v="function"==typeof this?this:Array,y=arguments.length,g=y>1?arguments[1]:void 0,m=void 0!==g,w=c(p),S=0;if(m&&(g=r(g,y>2?arguments[2]:void 0,2)),void 0==w||v==Array&&a(w))for(t=s(p.length),n=new v(t);t>S;S++)f=m?g(p[S],S):p[S],u(n,S,f);else for(d=w.call(p),h=d.next,n=new v;!(l=h.call(d)).done;S++)f=m?i(d,g,[l.value,S],!0):l.value,u(n,S,f);return n.length=S,n}},8418:function(e,t,n){"use strict";var r=n("c04e"),o=n("9bf2"),i=n("5c6c");e.exports=function(e,t,n){var a=r(t);a in e?o.f(e,a,i(0,n)):e[a]=n}},"96cf":function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,o="function"===typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(M){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var o=t&&t.prototype instanceof y?t:y,i=Object.create(o.prototype),a=new R(r||[]);return i._invoke=C(e,n,a),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(M){return{type:"throw",arg:M}}}e.wrap=c;var d="suspendedStart",h="suspendedYield",f="executing",p="completed",v={};function y(){}function g(){}function m(){}var w={};w[i]=function(){return this};var S=Object.getPrototypeOf,b=S&&S(S(x([])));b&&b!==n&&r.call(b,i)&&(w=b);var E=m.prototype=y.prototype=Object.create(w);function T(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function n(o,i,a,s){var u=l(e[o],e,i);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"===typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;function i(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}this._invoke=i}function C(e,t,n){var r=d;return function(o,i){if(r===f)throw new Error("Generator is already running");if(r===p){if("throw"===o)throw i;return O()}n.method=o,n.arg=i;while(1){var a=n.delegate;if(a){var s=k(a,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var u=l(e,t,n);if("normal"===u.type){if(r=n.done?p:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=p,n.method="throw",n.arg=u.arg)}}}function k(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator["return"]&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=l(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function x(e){if(e){var n=e[i];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){while(++o<e.length)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:O}}function O(){return{value:t,done:!0}}return g.prototype=E.constructor=m,m.constructor=g,g.displayName=u(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,s,"GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},T(I.prototype),I.prototype[a]=function(){return this},e.AsyncIterator=I,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new I(c(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(E),u(E,s,"Generator"),E[i]=function(){return this},E.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){while(t.length){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=x,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return s.type="throw",s.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;L(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:x(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=r}catch(o){Function("r","regeneratorRuntime = r")(r)}},"9bdd":function(e,t,n){var r=n("825a"),o=n("2a62");e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(a){throw o(e),a}}},a15b:function(e,t,n){"use strict";var r=n("23e7"),o=n("44ad"),i=n("fc6a"),a=n("a640"),s=[].join,u=o!=Object,c=a("join",",");r({target:"Array",proto:!0,forced:u||!c},{join:function(e){return s.call(i(this),void 0===e?",":e)}})},a630:function(e,t,n){var r=n("23e7"),o=n("4df4"),i=n("1c7e"),a=!i((function(e){Array.from(e)}));r({target:"Array",stat:!0,forced:a},{from:o})},a640:function(e,t,n){"use strict";var r=n("d039");e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){throw 1},1)}))}},a9c6:function(e,t){var n=n||{};n.ArrayBufferReader=function(e){var t=this;e.onblob=function(e){for(var n=window.atob(e),r=new ArrayBuffer(n.length),o=new Uint8Array(r),i=0;i<n.length;i++)o[i]=n.charCodeAt(i);t.ondata&&t.ondata(r)},e.onend=function(){t.onend&&t.onend()},this.ondata=null,this.onend=null};n=n||{};n.ArrayBufferWriter=function(e){var t=this;function r(t){for(var n="",r=0;r<t.byteLength;r++)n+=String.fromCharCode(t[r]);e.sendBlob(window.btoa(n))}e.onack=function(e){t.onack&&t.onack(e)},this.blobLength=n.ArrayBufferWriter.DEFAULT_BLOB_LENGTH,this.sendData=function(e){var n=new Uint8Array(e);if(n.length<=t.blobLength)r(n);else for(var o=0;o<n.length;o+=t.blobLength)r(n.subarray(o,o+t.blobLength))},this.sendEnd=function(){e.sendEnd()},this.onack=null},n.ArrayBufferWriter.DEFAULT_BLOB_LENGTH=6048;n=n||{};n.AudioContextFactory={singleton:null,getAudioContext:function(){var e=window.AudioContext||window.webkitAudioContext;if(e)try{return n.AudioContextFactory.singleton||(n.AudioContextFactory.singleton=new e),n.AudioContextFactory.singleton}catch(t){}return null}};n=n||{};n.AudioPlayer=function(){this.sync=function(){}},n.AudioPlayer.isSupportedType=function(e){return n.RawAudioPlayer.isSupportedType(e)},n.AudioPlayer.getSupportedTypes=function(){return n.RawAudioPlayer.getSupportedTypes()},n.AudioPlayer.getInstance=function(e,t){return n.RawAudioPlayer.isSupportedType(t)?new n.RawAudioPlayer(e,t):null},n.RawAudioPlayer=function(e,t){var r=n.RawAudioFormat.parse(t),o=n.AudioContextFactory.getAudioContext(),i=o.currentTime,a=new n.ArrayBufferReader(e),s=.02,u=.3,c=1===r.bytesPerSample?window.Int8Array:window.Int16Array,l=1===r.bytesPerSample?128:32768,d=[],h=function(e){if(e.length<=1)return e[0];var t=0;e.forEach((function(e){t+=e.length}));var n=0,r=new c(t);return e.forEach((function(e){r.set(e,n),n+=e.length})),r},f=function(e){for(var t=Number.MAX_VALUE,n=e.length,o=Math.floor(e.length/r.channels),i=Math.floor(r.rate*s),a=Math.max(r.channels*i,r.channels*(o-i)),u=a;u<e.length;u+=r.channels){for(var l=0,d=0;d<r.channels;d++)l+=Math.abs(e[u+d]);l<=t&&(n=u+r.channels,t=l)}return n===e.length?[e]:[new c(e.buffer.slice(0,n*r.bytesPerSample)),new c(e.buffer.slice(n*r.bytesPerSample))]},p=function(e){d.push(new c(e))},v=function(){var e=h(d);return e?(d=f(e),e=d.shift(),e):null},y=function(e){var t=e.length/r.channels,n=o.currentTime;i<n&&(i=n);for(var a=o.createBuffer(r.channels,t,r.rate),s=0;s<r.channels;s++)for(var u=a.getChannelData(s),c=s,d=0;d<t;d++)u[d]=e[c]/l,c+=r.channels;return a};a.ondata=function(e){p(new c(e));var t=v();if(t){var n=o.currentTime;i<n&&(i=n);var a=o.createBufferSource();a.connect(o.destination),a.start||(a.start=a.noteOn),a.buffer=y(t),a.start(i),i+=t.length/r.channels/r.rate}},this.sync=function(){var e=o.currentTime;i=Math.min(i,e+u)}},n.RawAudioPlayer.prototype=new n.AudioPlayer,n.RawAudioPlayer.isSupportedType=function(e){return!!n.AudioContextFactory.getAudioContext()&&null!==n.RawAudioFormat.parse(e)},n.RawAudioPlayer.getSupportedTypes=function(){return n.AudioContextFactory.getAudioContext()?["audio/L8","audio/L16"]:[]};n=n||{};n.AudioRecorder=function(){this.onclose=null,this.onerror=null},n.AudioRecorder.isSupportedType=function(e){return n.RawAudioRecorder.isSupportedType(e)},n.AudioRecorder.getSupportedTypes=function(){return n.RawAudioRecorder.getSupportedTypes()},n.AudioRecorder.getInstance=function(e,t){return n.RawAudioRecorder.isSupportedType(t)?new n.RawAudioRecorder(e,t):null},n.RawAudioRecorder=function(e,t){var r=this,o=2048,i=3,a=n.RawAudioFormat.parse(t),s=n.AudioContextFactory.getAudioContext();navigator.mediaDevices||(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia||(navigator.mediaDevices.getUserMedia=(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia).bind(navigator));var u=new n.ArrayBufferWriter(e),c=1===a.bytesPerSample?window.Int8Array:window.Int16Array,l=1===a.bytesPerSample?128:32768,d=0,h=0,f=null,p=null,v=null,y=function(e){if(0===e)return 1;var t=Math.PI*e;return Math.sin(t)/t},g=function(e,t){return-t<e&&e<t?y(e)*y(e/t):0},m=function(e,t){for(var n=(e.length-1)*t,r=Math.floor(n)-i+1,o=Math.floor(n)+i,a=0,s=r;s<=o;s++)a+=(e[s]||0)*g(n-s,i);return a},w=function(e){var t=e.length;d+=t;var n=Math.round(d*a.rate/e.sampleRate),r=n-h;h+=r;for(var o=new c(r*a.channels),i=0;i<a.channels;i++)for(var s=e.getChannelData(i),u=i,f=0;f<r;f++)o[u]=m(s,f/(r-1))*l,u+=a.channels;return o},S=function(e){v=s.createScriptProcessor(o,a.channels,a.channels),v.connect(s.destination),v.onaudioprocess=function(e){u.sendData(w(e.inputBuffer).buffer)},p=s.createMediaStreamSource(e),p.connect(v),"suspended"===s.state&&s.resume(),f=e},b=function(){u.sendEnd(),r.onerror&&r.onerror()},E=function(){var e=navigator.mediaDevices.getUserMedia({audio:!0},S,b);e&&e.then&&e.then(S,b)},T=function(){if(p&&p.disconnect(),v&&v.disconnect(),f)for(var e=f.getTracks(),t=0;t<e.length;t++)e[t].stop();v=null,p=null,f=null,u.sendEnd()};u.onack=function(e){e.code!==n.Status.Code.SUCCESS||f?(T(),u.onack=null,e.code===n.Status.Code.RESOURCE_CLOSED?r.onclose&&r.onclose():r.onerror&&r.onerror()):E()}},n.RawAudioRecorder.prototype=new n.AudioRecorder,n.RawAudioRecorder.isSupportedType=function(e){return!!n.AudioContextFactory.getAudioContext()&&null!==n.RawAudioFormat.parse(e)},n.RawAudioRecorder.getSupportedTypes=function(){return n.AudioContextFactory.getAudioContext()?["audio/L8","audio/L16"]:[]};n=n||{};n.BlobReader=function(e,t){var n,r=this,o=0;n=window.BlobBuilder?new BlobBuilder:window.WebKitBlobBuilder?new WebKitBlobBuilder:window.MozBlobBuilder?new MozBlobBuilder:new function(){var e=[];this.append=function(n){e.push(new Blob([n],{type:t}))},this.getBlob=function(){return new Blob(e,{type:t})}},e.onblob=function(t){for(var i=window.atob(t),a=new ArrayBuffer(i.length),s=new Uint8Array(a),u=0;u<i.length;u++)s[u]=i.charCodeAt(u);n.append(a),o+=a.byteLength,r.onprogress&&r.onprogress(a.byteLength),e.sendAck("OK",0)},e.onend=function(){r.onend&&r.onend()},this.getLength=function(){return o},this.getBlob=function(){return n.getBlob()},this.onprogress=null,this.onend=null};n=n||{};n.BlobWriter=function(e){var t=this,r=new n.ArrayBufferWriter(e);r.onack=function(e){t.onack&&t.onack(e)};var o=function(e,t,n){var r=(e.slice||e.webkitSlice||e.mozSlice).bind(e),o=n-t;if(o!==n){var i=r(t,o);if(i.size===o)return i}return r(t,n)};this.sendBlob=function(e){var n=0,i=new FileReader,a=function(){if(n>=e.size)t.oncomplete&&t.oncomplete(e);else{var a=o(e,n,n+r.blobLength);n+=r.blobLength,i.readAsArrayBuffer(a)}};i.onload=function(){r.sendData(i.result),r.onack=function(o){t.onack&&t.onack(o),o.isError()||(t.onprogress&&t.onprogress(e,n-r.blobLength),a())}},i.onerror=function(){t.onerror&&t.onerror(e,n,i.error)},a()},this.sendEnd=function(){r.sendEnd()},this.onack=null,this.onerror=null,this.onprogress=null,this.oncomplete=null};n=n||{};n.Client=function(e){var t=this,r=0,o=1,i=2,a=3,s=4,u=5,c=r,l=0,d=null,h={0:"butt",1:"round",2:"square"},f={0:"bevel",1:"miter",2:"round"},p=new n.Display,v={},y={},g={},m=[],w=[],S=[],b=new n.IntegerPool,E=[];function T(e){e!=c&&(c=e,t.onstatechange&&t.onstatechange(c))}function I(){return c==a||c==i}this.exportState=function(e){var t={currentState:c,currentTimestamp:l,layers:{}},n={};for(var r in v)n[r]=v[r];p.flush((function(){for(var r in n){var o=parseInt(r),i=n[r],a=i.toCanvas(),s={width:i.width,height:i.height};i.width&&i.height&&(s.url=a.toDataURL("image/png")),o>0&&(s.x=i.x,s.y=i.y,s.z=i.z,s.alpha=i.alpha,s.matrix=i.matrix,s.parent=k(i.parent)),t.layers[r]=s}e(t)}))},this.importState=function(e,t){var r,o;for(r in c=e.currentState,l=e.currentTimestamp,v)o=parseInt(r),o>0&&p.dispose(v[r]);for(r in v={},e.layers){o=parseInt(r);var i=e.layers[r],a=C(o);if(p.resize(a,i.width,i.height),i.url&&(p.setChannelMask(a,n.Layer.SRC),p.draw(a,0,0,i.url)),o>0&&i.parent>=0){var s=C(i.parent);p.move(a,s,i.x,i.y,i.z),p.shade(a,i.alpha);var u=i.matrix;p.distort(a,u[0],u[1],u[2],u[3],u[4],u[5])}}p.flush(t)},this.getDisplay=function(){return p},this.sendSize=function(t,n){I()&&e.sendMessage("size",t,n)},this.sendKeyEvent=function(t,n){I()&&e.sendMessage("key",n,t)},this.sendMouseState=function(t){if(I()){p.moveCursor(Math.floor(t.x),Math.floor(t.y));var n=0;t.left&&(n|=1),t.middle&&(n|=2),t.right&&(n|=4),t.up&&(n|=8),t.down&&(n|=16),e.sendMessage("mouse",Math.floor(t.x),Math.floor(t.y),n)}},this.createOutputStream=function(){var e=b.next(),r=E[e]=new n.OutputStream(t,e);return r},this.createAudioStream=function(n){var r=t.createOutputStream();return e.sendMessage("audio",r.index,n),r},this.createFileStream=function(n,r){var o=t.createOutputStream();return e.sendMessage("file",o.index,n,r),o},this.createPipeStream=function(n,r){var o=t.createOutputStream();return e.sendMessage("pipe",o.index,n,r),o},this.createClipboardStream=function(n){var r=t.createOutputStream();return e.sendMessage("clipboard",r.index,n),r},this.createArgumentValueStream=function(n,r){var o=t.createOutputStream();return e.sendMessage("argv",o.index,n,r),o},this.createObjectOutputStream=function(n,r,o){var i=t.createOutputStream();return e.sendMessage("put",n,i.index,r,o),i},this.requestObjectInputStream=function(t,n){I()&&e.sendMessage("get",t,n)},this.sendAck=function(t,n,r){I()&&e.sendMessage("ack",t,n,r)},this.sendBlob=function(t,n){I()&&e.sendMessage("blob",t,n)},this.endStream=function(t){I()&&(e.sendMessage("end",t),E[t]&&(b.free(t),delete E[t]))},this.onstatechange=null,this.onname=null,this.onerror=null,this.onaudio=null,this.onvideo=null,this.onargv=null,this.onclipboard=null,this.onfile=null,this.onfilesystem=null,this.onpipe=null,this.onrequired=null,this.onsync=null;var C=function(e){var t=v[e];return t||(t=0===e?p.getDefaultLayer():e>0?p.createLayer():p.createBuffer(),v[e]=t),t},k=function(e){if(!e)return null;for(var t in v)if(e===v[t])return parseInt(t);return null};function A(t){var r=m[t];return null==r&&(r=m[t]=new n.Parser,r.oninstruction=e.oninstruction),r}var L={"miter-limit":function(e,t){p.setMiterLimit(e,parseFloat(t))}},R={ack:function(e){var t=parseInt(e[0]),r=e[1],o=parseInt(e[2]),i=E[t];i&&(i.onack&&i.onack(new n.Status(o,r)),o>=256&&E[t]===i&&(b.free(t),delete E[t]))},arc:function(e){var t=C(parseInt(e[0])),n=parseInt(e[1]),r=parseInt(e[2]),o=parseInt(e[3]),i=parseFloat(e[4]),a=parseFloat(e[5]),s=parseInt(e[6]);p.arc(t,n,r,o,i,a,0!=s)},argv:function(e){var r=parseInt(e[0]),o=e[1],i=e[2];if(t.onargv){var a=w[r]=new n.InputStream(t,r);t.onargv(a,o,i)}else t.sendAck(r,"Receiving argument values unsupported",256)},audio:function(e){var r=parseInt(e[0]),o=e[1],i=w[r]=new n.InputStream(t,r),a=null;t.onaudio&&(a=t.onaudio(i,o)),a||(a=n.AudioPlayer.getInstance(i,o)),a?(y[r]=a,t.sendAck(r,"OK",0)):t.sendAck(r,"BAD TYPE",783)},blob:function(e){var t=parseInt(e[0]),n=e[1],r=w[t];r&&r.onblob&&r.onblob(n)},body:function(e){var r=parseInt(e[0]),o=S[r],i=parseInt(e[1]),a=e[2],s=e[3];if(o&&o.onbody){var u=w[i]=new n.InputStream(t,i);o.onbody(u,a,s)}else t.sendAck(i,"Receipt of body unsupported",256)},cfill:function(e){var t=parseInt(e[0]),n=C(parseInt(e[1])),r=parseInt(e[2]),o=parseInt(e[3]),i=parseInt(e[4]),a=parseInt(e[5]);p.setChannelMask(n,t),p.fillColor(n,r,o,i,a)},clip:function(e){var t=C(parseInt(e[0]));p.clip(t)},clipboard:function(e){var r=parseInt(e[0]),o=e[1];if(t.onclipboard){var i=w[r]=new n.InputStream(t,r);t.onclipboard(i,o)}else t.sendAck(r,"Clipboard unsupported",256)},close:function(e){var t=C(parseInt(e[0]));p.close(t)},copy:function(e){var t=C(parseInt(e[0])),n=parseInt(e[1]),r=parseInt(e[2]),o=parseInt(e[3]),i=parseInt(e[4]),a=parseInt(e[5]),s=C(parseInt(e[6])),u=parseInt(e[7]),c=parseInt(e[8]);p.setChannelMask(s,a),p.copy(t,n,r,o,i,s,u,c)},cstroke:function(e){var t=parseInt(e[0]),n=C(parseInt(e[1])),r=h[parseInt(e[2])],o=f[parseInt(e[3])],i=parseInt(e[4]),a=parseInt(e[5]),s=parseInt(e[6]),u=parseInt(e[7]),c=parseInt(e[8]);p.setChannelMask(n,t),p.strokeColor(n,r,o,i,a,s,u,c)},cursor:function(e){var t=parseInt(e[0]),n=parseInt(e[1]),r=C(parseInt(e[2])),o=parseInt(e[3]),i=parseInt(e[4]),a=parseInt(e[5]),s=parseInt(e[6]);p.setCursor(t,n,r,o,i,a,s)},curve:function(e){var t=C(parseInt(e[0])),n=parseInt(e[1]),r=parseInt(e[2]),o=parseInt(e[3]),i=parseInt(e[4]),a=parseInt(e[5]),s=parseInt(e[6]);p.curveTo(t,n,r,o,i,a,s)},disconnect:function(e){t.disconnect()},dispose:function(e){var t=parseInt(e[0]);if(t>0){var n=C(t);p.dispose(n),delete v[t]}else t<0&&delete v[t]},distort:function(e){var t=parseInt(e[0]),n=parseFloat(e[1]),r=parseFloat(e[2]),o=parseFloat(e[3]),i=parseFloat(e[4]),a=parseFloat(e[5]),s=parseFloat(e[6]);if(t>=0){var u=C(t);p.distort(u,n,r,o,i,a,s)}},error:function(e){var r=e[0],o=parseInt(e[1]);t.onerror&&t.onerror(new n.Status(o,r)),t.disconnect()},end:function(e){var t=parseInt(e[0]),n=w[t];n&&(n.onend&&n.onend(),delete w[t])},file:function(e){var r=parseInt(e[0]),o=e[1],i=e[2];if(t.onfile){var a=w[r]=new n.InputStream(t,r);t.onfile(a,o,i)}else t.sendAck(r,"File transfer unsupported",256)},filesystem:function(e){var r=parseInt(e[0]),o=e[1];if(t.onfilesystem){var i=S[r]=new n.Object(t,r);t.onfilesystem(i,o)}},identity:function(e){var t=C(parseInt(e[0]));p.setTransform(t,1,0,0,1,0,0)},img:function(e){var r=parseInt(e[0]),o=parseInt(e[1]),i=C(parseInt(e[2])),a=e[3],s=parseInt(e[4]),u=parseInt(e[5]),c=w[r]=new n.InputStream(t,r);p.setChannelMask(i,o),p.drawStream(i,s,u,c,a)},jpeg:function(e){var t=parseInt(e[0]),n=C(parseInt(e[1])),r=parseInt(e[2]),o=parseInt(e[3]),i=e[4];p.setChannelMask(n,t),p.draw(n,r,o,"data:image/jpeg;base64,"+i)},lfill:function(e){var t=parseInt(e[0]),n=C(parseInt(e[1])),r=C(parseInt(e[2]));p.setChannelMask(n,t),p.fillLayer(n,r)},line:function(e){var t=C(parseInt(e[0])),n=parseInt(e[1]),r=parseInt(e[2]);p.lineTo(t,n,r)},lstroke:function(e){var t=parseInt(e[0]),n=C(parseInt(e[1])),r=C(parseInt(e[2]));p.setChannelMask(n,t),p.strokeLayer(n,r)},mouse:function(e){var t=parseInt(e[0]),n=parseInt(e[1]);p.showCursor(!0),p.moveCursor(t,n)},move:function(e){var t=parseInt(e[0]),n=parseInt(e[1]),r=parseInt(e[2]),o=parseInt(e[3]),i=parseInt(e[4]);if(t>0&&n>=0){var a=C(t),s=C(n);p.move(a,s,r,o,i)}},name:function(e){t.onname&&t.onname(e[0])},nest:function(e){var t=A(parseInt(e[0]));t.receive(e[1])},pipe:function(e){var r=parseInt(e[0]),o=e[1],i=e[2];if(t.onpipe){var a=w[r]=new n.InputStream(t,r);t.onpipe(a,o,i)}else t.sendAck(r,"Named pipes unsupported",256)},png:function(e){var t=parseInt(e[0]),n=C(parseInt(e[1])),r=parseInt(e[2]),o=parseInt(e[3]),i=e[4];p.setChannelMask(n,t),p.draw(n,r,o,"data:image/png;base64,"+i)},pop:function(e){var t=C(parseInt(e[0]));p.pop(t)},push:function(e){var t=C(parseInt(e[0]));p.push(t)},rect:function(e){var t=C(parseInt(e[0])),n=parseInt(e[1]),r=parseInt(e[2]),o=parseInt(e[3]),i=parseInt(e[4]);p.rect(t,n,r,o,i)},required:function(e){t.onrequired&&t.onrequired(e)},reset:function(e){var t=C(parseInt(e[0]));p.reset(t)},set:function(e){var t=C(parseInt(e[0])),n=e[1],r=e[2],o=L[n];o&&o(t,r)},shade:function(e){var t=parseInt(e[0]),n=parseInt(e[1]);if(t>=0){var r=C(t);p.shade(r,n)}},size:function(e){var t=parseInt(e[0]),n=C(t),r=parseInt(e[1]),o=parseInt(e[2]);p.resize(n,r,o)},start:function(e){var t=C(parseInt(e[0])),n=parseInt(e[1]),r=parseInt(e[2]);p.moveTo(t,n,r)},sync:function(n){var r=parseInt(n[0]);p.flush((function(){for(var t in y){var n=y[t];n&&n.sync()}r!==l&&(e.sendMessage("sync",r),l=r)})),c===i&&T(a),t.onsync&&t.onsync(r)},transfer:function(e){var t=C(parseInt(e[0])),r=parseInt(e[1]),o=parseInt(e[2]),i=parseInt(e[3]),a=parseInt(e[4]),s=parseInt(e[5]),u=C(parseInt(e[6])),c=parseInt(e[7]),l=parseInt(e[8]);3===s?p.put(t,r,o,i,a,u,c,l):5!==s&&p.transfer(t,r,o,i,a,u,c,l,n.Client.DefaultTransferFunction[s])},transform:function(e){var t=C(parseInt(e[0])),n=parseFloat(e[1]),r=parseFloat(e[2]),o=parseFloat(e[3]),i=parseFloat(e[4]),a=parseFloat(e[5]),s=parseFloat(e[6]);p.transform(t,n,r,o,i,a,s)},undefine:function(e){var t=parseInt(e[0]),n=S[t];n&&n.onundefine&&n.onundefine()},video:function(e){var r=parseInt(e[0]),o=C(parseInt(e[1])),i=e[2],a=w[r]=new n.InputStream(t,r),s=null;t.onvideo&&(s=t.onvideo(a,o,i)),s||(s=n.VideoPlayer.getInstance(a,o,i)),s?(g[r]=s,t.sendAck(r,"OK",0)):t.sendAck(r,"BAD TYPE",783)}};e.oninstruction=function(e,t){var n=R[e];n&&n(t)},this.disconnect=function(){c!=u&&c!=s&&(T(s),d&&window.clearInterval(d),e.sendMessage("disconnect"),e.disconnect(),T(u))},this.connect=function(t){T(o);try{e.connect(t)}catch(n){throw T(r),n}d=window.setInterval((function(){e.sendMessage("nop")}),5e3),T(i)}},n.Client.DefaultTransferFunction={0:function(e,t){t.red=t.green=t.blue=0},15:function(e,t){t.red=t.green=t.blue=255},3:function(e,t){t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha},5:function(e,t){},12:function(e,t){t.red=255&~e.red,t.green=255&~e.green,t.blue=255&~e.blue,t.alpha=e.alpha},10:function(e,t){t.red=255&~t.red,t.green=255&~t.green,t.blue=255&~t.blue},1:function(e,t){t.red=e.red&t.red,t.green=e.green&t.green,t.blue=e.blue&t.blue},14:function(e,t){t.red=255&~(e.red&t.red),t.green=255&~(e.green&t.green),t.blue=255&~(e.blue&t.blue)},7:function(e,t){t.red=e.red|t.red,t.green=e.green|t.green,t.blue=e.blue|t.blue},8:function(e,t){t.red=255&~(e.red|t.red),t.green=255&~(e.green|t.green),t.blue=255&~(e.blue|t.blue)},6:function(e,t){t.red=e.red^t.red,t.green=e.green^t.green,t.blue=e.blue^t.blue},9:function(e,t){t.red=255&~(e.red^t.red),t.green=255&~(e.green^t.green),t.blue=255&~(e.blue^t.blue)},4:function(e,t){t.red=~e.red&t.red&255,t.green=~e.green&t.green&255,t.blue=~e.blue&t.blue&255},13:function(e,t){t.red=255&(~e.red|t.red),t.green=255&(~e.green|t.green),t.blue=255&(~e.blue|t.blue)},2:function(e,t){t.red=e.red&~t.red&255,t.green=e.green&~t.green&255,t.blue=e.blue&~t.blue&255},11:function(e,t){t.red=255&(e.red|~t.red),t.green=255&(e.green|~t.green),t.blue=255&(e.blue|~t.blue)}};n=n||{};n.DataURIReader=function(e,t){var n=this,r="data:"+t+";base64,";e.onblob=function(e){r+=e},e.onend=function(){n.onend&&n.onend()},this.getURI=function(){return r},this.onend=null};n=n||{};n.Display=function(){var e=this,t=0,r=0,o=1,i=document.createElement("div");i.style.position="relative",i.style.width=t+"px",i.style.height=r+"px",i.style.transformOrigin=i.style.webkitTransformOrigin=i.style.MozTransformOrigin=i.style.OTransformOrigin=i.style.msTransformOrigin="0 0";var a=new n.Display.VisibleLayer(t,r),s=new n.Display.VisibleLayer(0,0);s.setChannelMask(n.Layer.SRC),i.appendChild(a.getElement()),i.appendChild(s.getElement());var u=document.createElement("div");u.style.position="relative",u.style.width=t*o+"px",u.style.height=r*o+"px",u.appendChild(i),this.cursorHotspotX=0,this.cursorHotspotY=0,this.cursorX=0,this.cursorY=0,this.onresize=null,this.oncursor=null;var c=[],l=[];function d(){var e=0;while(e<l.length){var t=l[e];if(!t.isReady())break;t.flush(),e++}l.splice(0,e)}function h(e,t){this.isReady=function(){for(var e=0;e<t.length;e++)if(t[e].blocked)return!1;return!0},this.flush=function(){for(var n=0;n<t.length;n++)t[n].execute();e&&e()}}function f(e,t){var n=this;this.blocked=t,this.unblock=function(){n.blocked&&(n.blocked=!1,d())},this.execute=function(){e&&e()}}function p(e,t){var n=new f(e,t);return c.push(n),n}this.getElement=function(){return u},this.getWidth=function(){return t},this.getHeight=function(){return r},this.getDefaultLayer=function(){return a},this.getCursorLayer=function(){return s},this.createLayer=function(){var e=new n.Display.VisibleLayer(t,r);return e.move(a,0,0,0),e},this.createBuffer=function(){var e=new n.Layer(0,0);return e.autosize=1,e},this.flush=function(e){l.push(new h(e,c)),c=[],d()},this.setCursor=function(t,n,r,o,i,a,u){p((function(){e.cursorHotspotX=t,e.cursorHotspotY=n,s.resize(a,u),s.copy(r,o,i,a,u,0,0),e.moveCursor(e.cursorX,e.cursorY),e.oncursor&&e.oncursor(s.toCanvas(),t,n)}))},this.showCursor=function(e){var t=s.getElement(),n=t.parentNode;!1===e?n&&n.removeChild(t):n!==i&&i.appendChild(t)},this.moveCursor=function(t,n){s.translate(t-e.cursorHotspotX,n-e.cursorHotspotY),e.cursorX=t,e.cursorY=n},this.resize=function(n,s,c){p((function(){n.resize(s,c),n===a&&(t=s,r=c,i.style.width=t+"px",i.style.height=r+"px",u.style.width=t*o+"px",u.style.height=r*o+"px",e.onresize&&e.onresize(s,c))}))},this.drawImage=function(e,t,n,r){p((function(){e.drawImage(t,n,r)}))},this.drawBlob=function(e,t,n,r){var o;if(window.createImageBitmap){var i;o=p((function(){e.drawImage(t,n,i)}),!0),window.createImageBitmap(r).then((function(e){i=e,o.unblock()}))}else{var a=URL.createObjectURL(r);o=p((function(){s.width&&s.height&&e.drawImage(t,n,s),URL.revokeObjectURL(a)}),!0);var s=new Image;s.onload=o.unblock,s.onerror=o.unblock,s.src=a}},this.drawStream=function(t,r,o,i,a){if(window.createImageBitmap){var s=new n.BlobReader(i,a);s.onend=function(){e.drawBlob(t,r,o,s.getBlob())}}else{s=new n.DataURIReader(i,a);s.onend=function(){e.draw(t,r,o,s.getURI())}}},this.draw=function(e,t,n,r){var o=p((function(){i.width&&i.height&&e.drawImage(t,n,i)}),!0),i=new Image;i.onload=o.unblock,i.onerror=o.unblock,i.src=r},this.play=function(e,t,n,r){var o=document.createElement("video");o.type=t,o.src=r,o.addEventListener("play",(function(){function t(){e.drawImage(0,0,o),o.ended||window.setTimeout(t,20)}t()}),!1),p(o.play)},this.transfer=function(e,t,n,r,o,i,a,s,u){p((function(){i.transfer(e,t,n,r,o,a,s,u)}))},this.put=function(e,t,n,r,o,i,a,s){p((function(){i.put(e,t,n,r,o,a,s)}))},this.copy=function(e,t,n,r,o,i,a,s){p((function(){i.copy(e,t,n,r,o,a,s)}))},this.moveTo=function(e,t,n){p((function(){e.moveTo(t,n)}))},this.lineTo=function(e,t,n){p((function(){e.lineTo(t,n)}))},this.arc=function(e,t,n,r,o,i,a){p((function(){e.arc(t,n,r,o,i,a)}))},this.curveTo=function(e,t,n,r,o,i,a){p((function(){e.curveTo(t,n,r,o,i,a)}))},this.close=function(e){p((function(){e.close()}))},this.rect=function(e,t,n,r,o){p((function(){e.rect(t,n,r,o)}))},this.clip=function(e){p((function(){e.clip()}))},this.strokeColor=function(e,t,n,r,o,i,a,s){p((function(){e.strokeColor(t,n,r,o,i,a,s)}))},this.fillColor=function(e,t,n,r,o){p((function(){e.fillColor(t,n,r,o)}))},this.strokeLayer=function(e,t,n,r,o){p((function(){e.strokeLayer(t,n,r,o)}))},this.fillLayer=function(e,t){p((function(){e.fillLayer(t)}))},this.push=function(e){p((function(){e.push()}))},this.pop=function(e){p((function(){e.pop()}))},this.reset=function(e){p((function(){e.reset()}))},this.setTransform=function(e,t,n,r,o,i,a){p((function(){e.setTransform(t,n,r,o,i,a)}))},this.transform=function(e,t,n,r,o,i,a){p((function(){e.transform(t,n,r,o,i,a)}))},this.setChannelMask=function(e,t){p((function(){e.setChannelMask(t)}))},this.setMiterLimit=function(e,t){p((function(){e.setMiterLimit(t)}))},this.dispose=function(e){p((function(){e.dispose()}))},this.distort=function(e,t,n,r,o,i,a){p((function(){e.distort(t,n,r,o,i,a)}))},this.move=function(e,t,n,r,o){p((function(){e.move(t,n,r,o)}))},this.shade=function(e,t){p((function(){e.shade(t)}))},this.scale=function(e){i.style.transform=i.style.WebkitTransform=i.style.MozTransform=i.style.OTransform=i.style.msTransform="scale("+e+","+e+")",o=e,u.style.width=t*o+"px",u.style.height=r*o+"px"},this.getScale=function(){return o},this.flatten=function(){var e=document.createElement("canvas");e.width=a.width,e.height=a.height;var t=e.getContext("2d");function n(e){var t=[];for(var n in e.children)t.push(e.children[n]);return t.sort((function(e,t){var n=e.z-t.z;if(0!==n)return n;var r=e.getElement(),o=t.getElement(),i=o.compareDocumentPosition(r);return i&Node.DOCUMENT_POSITION_PRECEDING?-1:i&Node.DOCUMENT_POSITION_FOLLOWING?1:0})),t}function r(e,o,i){if(e.width>0&&e.height>0){var a=t.globalAlpha;t.globalAlpha*=e.alpha/255,t.drawImage(e.getCanvas(),o,i);for(var s=n(e),u=0;u<s.length;u++){var c=s[u];r(c,o+c.x,i+c.y)}t.globalAlpha=a}}return r(a,0,0),e}},n.Display.VisibleLayer=function(e,t){n.Layer.apply(this,[e,t]);var r=this;this.__unique_id=n.Display.VisibleLayer.__next_id++,this.alpha=255,this.x=0,this.y=0,this.z=0,this.matrix=[1,0,0,1,0,0],this.parent=null,this.children={};var o=r.getCanvas();o.style.position="absolute",o.style.left="0px",o.style.top="0px";var i=document.createElement("div");i.appendChild(o),i.style.width=e+"px",i.style.height=t+"px",i.style.position="absolute",i.style.left="0px",i.style.top="0px",i.style.overflow="hidden";var a=this.resize;this.resize=function(e,t){i.style.width=e+"px",i.style.height=t+"px",a(e,t)},this.getElement=function(){return i};var s="translate(0px, 0px)",u="matrix(1, 0, 0, 1, 0, 0)";this.translate=function(e,t){r.x=e,r.y=t,s="translate("+e+"px,"+t+"px)",i.style.transform=i.style.WebkitTransform=i.style.MozTransform=i.style.OTransform=i.style.msTransform=s+" "+u},this.move=function(e,t,n,o){if(r.parent!==e){r.parent&&delete r.parent.children[r.__unique_id],r.parent=e,e.children[r.__unique_id]=r;var a=e.getElement();a.appendChild(i)}r.translate(t,n),r.z=o,i.style.zIndex=o},this.shade=function(e){r.alpha=e,i.style.opacity=e/255},this.dispose=function(){r.parent&&(delete r.parent.children[r.__unique_id],r.parent=null),i.parentNode&&i.parentNode.removeChild(i)},this.distort=function(e,t,n,o,a,c){r.matrix=[e,t,n,o,a,c],u="matrix("+e+","+t+","+n+","+o+","+a+","+c+")",i.style.transform=i.style.WebkitTransform=i.style.MozTransform=i.style.OTransform=i.style.msTransform=s+" "+u}},n.Display.VisibleLayer.__next_id=0;n=n||{};n.InputSink=function(){var e=this,t=document.createElement("textarea");t.style.position="fixed",t.style.outline="none",t.style.border="none",t.style.margin="0",t.style.padding="0",t.style.height="0",t.style.width="0",t.style.left="0",t.style.bottom="0",t.style.resize="none",t.style.background="transparent",t.style.color="transparent",t.addEventListener("keypress",(function(e){t.value=""}),!1),t.addEventListener("compositionend",(function(e){e.data&&(t.value="")}),!1),t.addEventListener("input",(function(e){e.data&&!e.isComposing&&(t.value="")}),!1),t.addEventListener("focus",(function(){window.setTimeout((function(){t.click(),t.select()}),0)}),!0),this.focus=function(){window.setTimeout((function(){t.focus()}),0)},this.getElement=function(){return t},document.addEventListener("keydown",(function(t){var n=document.activeElement;if(n&&n!==document.body){var r=n.getBoundingClientRect();if(r.left+r.width>0&&r.top+r.height>0)return}e.focus()}),!0)};n=n||{};n.InputStream=function(e,t){var n=this;this.index=t,this.onblob=null,this.onend=null,this.sendAck=function(t,r){e.sendAck(n.index,t,r)}};n=n||{};n.IntegerPool=function(){var e=this,t=[];this.next_int=0,this.next=function(){return t.length>0?t.shift():e.next_int++},this.free=function(e){t.push(e)}};n=n||{};n.JSONReader=function(e){var t=this,r=new n.StringReader(e),o="";this.getLength=function(){return o.length},this.getJSON=function(){return JSON.parse(o)},r.ontext=function(e){o+=e,t.onprogress&&t.onprogress(e.length)},r.onend=function(){t.onend&&t.onend()},this.onprogress=null,this.onend=null};n=n||{};n.Keyboard=function(e){var t=this,r=n.Keyboard._nextID++,o="_GUAC_KEYBOARD_HANDLED_BY_"+r;this.onkeydown=null,this.onkeyup=null;var i={keyupUnreliable:!1,altIsTypableOnly:!1,capsLockKeyupUnreliable:!1};navigator&&navigator.platform&&(navigator.platform.match(/ipad|iphone|ipod/i)?i.keyupUnreliable=!0:navigator.platform.match(/^mac/i)&&(i.altIsTypableOnly=!0,i.capsLockKeyupUnreliable=!0));var a=function(){var e=this;this.timestamp=(new Date).getTime(),this.defaultPrevented=!1,this.keysym=null,this.reliable=!1,this.getAge=function(){return(new Date).getTime()-e.timestamp}},s=function(e,n,r,o){a.apply(this),this.keyCode=e,this.keyIdentifier=n,this.key=r,this.location=o,this.keysym=b(r,o)||I(e,o),this.keyupReliable=!i.keyupUnreliable,this.keysym&&!S(this.keysym)&&(this.reliable=!0),!this.keysym&&C(e,n)&&(this.keysym=b(n,o,t.modifiers.shift)),(t.modifiers.meta&&65511!==this.keysym&&65512!==this.keysym||65509===this.keysym&&i.capsLockKeyupUnreliable)&&(this.keyupReliable=!1);var s=!t.modifiers.ctrl&&!i.altIsTypableOnly,u=!t.modifiers.alt;(u&&t.modifiers.ctrl||s&&t.modifiers.alt||t.modifiers.meta||t.modifiers.hyper)&&(this.reliable=!0),y[e]=this.keysym};s.prototype=new a;var u=function(e){a.apply(this),this.charCode=e,this.keysym=T(e),this.reliable=!0};u.prototype=new a;var c=function(e,n,r,o){a.apply(this),this.keyCode=e,this.keyIdentifier=n,this.key=r,this.location=o,this.keysym=I(e,o)||b(r,o),t.pressed[this.keysym]||(this.keysym=y[e]||this.keysym),this.reliable=!0};c.prototype=new a;var l=[],d={8:[65288],9:[65289],12:[65291,65291,65291,65461],13:[65293],16:[65505,65505,65506],17:[65507,65507,65508],18:[65513,65513,65027],19:[65299],20:[65509],27:[65307],32:[32],33:[65365,65365,65365,65465],34:[65366,65366,65366,65459],35:[65367,65367,65367,65457],36:[65360,65360,65360,65463],37:[65361,65361,65361,65460],38:[65362,65362,65362,65464],39:[65363,65363,65363,65462],40:[65364,65364,65364,65458],45:[65379,65379,65379,65456],46:[65535,65535,65535,65454],91:[65515],92:[65383],93:null,96:[65456],97:[65457],98:[65458],99:[65459],100:[65460],101:[65461],102:[65462],103:[65463],104:[65464],105:[65465],106:[65450],107:[65451],109:[65453],110:[65454],111:[65455],112:[65470],113:[65471],114:[65472],115:[65473],116:[65474],117:[65475],118:[65476],119:[65477],120:[65478],121:[65479],122:[65480],123:[65481],144:[65407],145:[65300],225:[65027]},h={Again:[65382],AllCandidates:[65341],Alphanumeric:[65328],Alt:[65513,65513,65027],Attn:[64782],AltGraph:[65027],ArrowDown:[65364],ArrowLeft:[65361],ArrowRight:[65363],ArrowUp:[65362],Backspace:[65288],CapsLock:[65509],Cancel:[65385],Clear:[65291],Convert:[65313],Copy:[64789],Crsel:[64796],CrSel:[64796],CodeInput:[65335],Compose:[65312],Control:[65507,65507,65508],ContextMenu:[65383],Delete:[65535],Down:[65364],End:[65367],Enter:[65293],EraseEof:[64774],Escape:[65307],Execute:[65378],Exsel:[64797],ExSel:[64797],F1:[65470],F2:[65471],F3:[65472],F4:[65473],F5:[65474],F6:[65475],F7:[65476],F8:[65477],F9:[65478],F10:[65479],F11:[65480],F12:[65481],F13:[65482],F14:[65483],F15:[65484],F16:[65485],F17:[65486],F18:[65487],F19:[65488],F20:[65489],F21:[65490],F22:[65491],F23:[65492],F24:[65493],Find:[65384],GroupFirst:[65036],GroupLast:[65038],GroupNext:[65032],GroupPrevious:[65034],FullWidth:null,HalfWidth:null,HangulMode:[65329],Hankaku:[65321],HanjaMode:[65332],Help:[65386],Hiragana:[65317],HiraganaKatakana:[65319],Home:[65360],Hyper:[65517,65517,65518],Insert:[65379],JapaneseHiragana:[65317],JapaneseKatakana:[65318],JapaneseRomaji:[65316],JunjaMode:[65336],KanaMode:[65325],KanjiMode:[65313],Katakana:[65318],Left:[65361],Meta:[65511,65511,65512],ModeChange:[65406],NumLock:[65407],PageDown:[65366],PageUp:[65365],Pause:[65299],Play:[64790],PreviousCandidate:[65342],PrintScreen:[65377],Redo:[65382],Right:[65363],RomanCharacters:null,Scroll:[65300],Select:[65376],Separator:[65452],Shift:[65505,65505,65506],SingleCandidate:[65340],Super:[65515,65515,65516],Tab:[65289],UIKeyInputDownArrow:[65364],UIKeyInputEscape:[65307],UIKeyInputLeftArrow:[65361],UIKeyInputRightArrow:[65363],UIKeyInputUpArrow:[65362],Up:[65362],Undo:[65381],Win:[65515],Zenkaku:[65320],ZenkakuHankaku:[65322]},f={65027:!0,65505:!0,65506:!0,65507:!0,65508:!0,65509:!0,65511:!0,65512:!0,65513:!0,65514:!0,65515:!0,65516:!0};this.modifiers=new n.Keyboard.ModifierState,this.pressed={};var p={},v={},y={},g=null,m=null,w=function(e,t){return e?e[t]||e[0]:null},S=function(e){return e>=0&&e<=255||16777216===(4294901760&e)};function b(e,t,n){if(!e)return null;var r,o=e.indexOf("U+");if(o>=0){var i=e.substring(o+2);r=String.fromCharCode(parseInt(i,16))}else{if(1!==e.length||3===t)return w(h[e],t);r=e}!0===n?r=r.toUpperCase():!1===n&&(r=r.toLowerCase());var a=r.charCodeAt(0);return T(a)}function E(e){return e<=31||e>=127&&e<=159}function T(e){return E(e)?65280|e:e>=0&&e<=255?e:e>=256&&e<=1114111?16777216|e:null}function I(e,t){return w(d[e],t)}var C=function(e,t){if(!t)return!1;var n=t.indexOf("U+");if(-1===n)return!0;var r=parseInt(t.substring(n+2),16);return e!==r||(e>=65&&e<=90||e>=48&&e<=57)};this.press=function(e){if(null!==e){if(!t.pressed[e]&&(t.pressed[e]=!0,t.onkeydown)){var n=t.onkeydown(e);return v[e]=n,window.clearTimeout(g),window.clearInterval(m),f[e]||(g=window.setTimeout((function(){m=window.setInterval((function(){t.onkeyup(e),t.onkeydown(e)}),50)}),500)),n}return v[e]||!1}},this.release=function(e){t.pressed[e]&&(delete t.pressed[e],delete p[e],window.clearTimeout(g),window.clearInterval(m),null!==e&&t.onkeyup&&t.onkeyup(e))},this.type=function(e){for(var n=0;n<e.length;n++){var r=e.codePointAt?e.codePointAt(n):e.charCodeAt(n),o=T(r);t.press(o),t.release(o)}},this.reset=function(){for(var e in t.pressed)t.release(parseInt(e));l=[]};var k=function(e,n,r,o){var i;if(-1===r.indexOf(o.keysym))if(e&&!1===n)for(i=0;i<r.length;i++)t.release(r[i]);else if(!e&&n){for(i=0;i<r.length;i++)if(t.pressed[r[i]])return;var a=r[0];o.keysym&&(p[a]=!0),t.press(a)}},A=function(e,r){var o=n.Keyboard.ModifierState.fromKeyboardEvent(e);k(t.modifiers.alt,o.alt,[65513,65514,65027],r),k(t.modifiers.shift,o.shift,[65505,65506],r),k(t.modifiers.ctrl,o.ctrl,[65507,65508],r),k(t.modifiers.meta,o.meta,[65511,65512],r),k(t.modifiers.hyper,o.hyper,[65515,65516],r),t.modifiers=o},L=function(){for(var e in t.pressed)if(!p[e])return!1;return!0};function R(){var e,n=O();if(!n)return!1;do{e=n,n=O()}while(null!==n);return L()&&t.reset(),e.defaultPrevented}var x=function(e){t.modifiers.ctrl&&t.modifiers.alt&&(e>=65&&e<=90||e>=97&&e<=122||(e<=255||16777216===(4278190080&e))&&(t.release(65507),t.release(65508),t.release(65513),t.release(65514)))},O=function(){var e=l[0];if(!e)return null;if(!(e instanceof s)){if(e instanceof c&&!i.keyupUnreliable){n=e.keysym;return n?(t.release(n),delete y[e.keyCode],e.defaultPrevented=!0,l.shift()):(t.reset(),e)}return l.shift()}var n=null,r=[];if(e.reliable?(n=e.keysym,r=l.splice(0,1)):l[1]instanceof u?(n=l[1].keysym,r=l.splice(0,2)):l[1]&&(n=e.keysym,r=l.splice(0,1)),r.length>0){if(n){x(n);var o=!t.press(n);y[e.keyCode]=n,e.keyupReliable||t.release(n);for(var a=0;a<r.length;a++)r[a].defaultPrevented=o}return e}return null},M=function(e){return"location"in e?e.location:"keyLocation"in e?e.keyLocation:0},N=function(e){return!e[o]&&(e[o]=!0,!0)};this.listenTo=function(e){e.addEventListener("keydown",(function(e){if(t.onkeydown&&N(e)){var n;window.event?n=window.event.keyCode:e.which&&(n=e.which);var r=new s(n,e.keyIdentifier,e.key,M(e));A(e,r),229!==n&&(l.push(r),R()&&e.preventDefault())}}),!0),e.addEventListener("keypress",(function(e){if((t.onkeydown||t.onkeyup)&&N(e)){var n;window.event?n=window.event.keyCode:e.which&&(n=e.which);var r=new u(n);A(e,r),l.push(r),R()&&e.preventDefault()}}),!0),e.addEventListener("keyup",(function(e){if(t.onkeyup&&N(e)){var n;e.preventDefault(),window.event?n=window.event.keyCode:e.which&&(n=e.which);var r=new c(n,e.keyIdentifier,e.key,M(e));A(e,r),l.push(r),R()}}),!0);var n=function(n){(t.onkeydown||t.onkeyup)&&N(n)&&n.data&&!n.isComposing&&(e.removeEventListener("compositionend",r,!1),t.type(n.data))},r=function(r){(t.onkeydown||t.onkeyup)&&N(r)&&r.data&&(e.removeEventListener("input",n,!1),t.type(r.data))};e.addEventListener("input",n,!1),e.addEventListener("compositionend",r,!1)},e&&t.listenTo(e)},n.Keyboard._nextID=0,n.Keyboard.ModifierState=function(){this.shift=!1,this.ctrl=!1,this.alt=!1,this.meta=!1,this.hyper=!1},n.Keyboard.ModifierState.fromKeyboardEvent=function(e){var t=new n.Keyboard.ModifierState;return t.shift=e.shiftKey,t.ctrl=e.ctrlKey,t.alt=e.altKey,t.meta=e.metaKey,e.getModifierState&&(t.hyper=e.getModifierState("OS")||e.getModifierState("Super")||e.getModifierState("Hyper")||e.getModifierState("Win")),t};n=n||{};n.Layer=function(e,t){var r=this,o=64,i=document.createElement("canvas"),a=i.getContext("2d");a.save();var s=!0,u=!0,c=0,l={1:"destination-in",2:"destination-out",4:"source-in",6:"source-atop",8:"source-out",9:"destination-atop",10:"xor",11:"destination-over",12:"copy",14:"source-over",15:"lighter"},d=function(e,t){e=e||0,t=t||0;var n=Math.ceil(e/o)*o,u=Math.ceil(t/o)*o;if(i.width!==n||i.height!==u){var l=null;if(!s&&0!==i.width&&0!==i.height){l=document.createElement("canvas"),l.width=Math.min(r.width,e),l.height=Math.min(r.height,t);var d=l.getContext("2d");d.drawImage(i,0,0,l.width,l.height,0,0,l.width,l.height)}var h=a.globalCompositeOperation;i.width=n,i.height=u,l&&a.drawImage(l,0,0,l.width,l.height,0,0,l.width,l.height),a.globalCompositeOperation=h,c=0,a.save()}else r.reset();r.width=e,r.height=t};function h(e,t,n,o){var i,a,s=n+e,u=o+t;i=s>r.width?s:r.width,a=u>r.height?u:r.height,r.resize(i,a)}this.autosize=!1,this.width=e,this.height=t,this.getCanvas=function(){return i},this.toCanvas=function(){var e=document.createElement("canvas");e.width=r.width,e.height=r.height;var t=e.getContext("2d");return t.drawImage(r.getCanvas(),0,0),e},this.resize=function(e,t){e===r.width&&t===r.height||d(e,t)},this.drawImage=function(e,t,n){r.autosize&&h(e,t,n.width,n.height),a.drawImage(n,e,t),s=!1},this.transfer=function(e,t,o,i,u,c,l,d){var f=e.getCanvas();if(!(t>=f.width||o>=f.height)&&(t+i>f.width&&(i=f.width-t),o+u>f.height&&(u=f.height-o),0!==i&&0!==u)){r.autosize&&h(c,l,i,u);for(var p=e.getCanvas().getContext("2d").getImageData(t,o,i,u),v=a.getImageData(c,l,i,u),y=0;y<i*u*4;y+=4){var g=new n.Layer.Pixel(p.data[y],p.data[y+1],p.data[y+2],p.data[y+3]),m=new n.Layer.Pixel(v.data[y],v.data[y+1],v.data[y+2],v.data[y+3]);d(g,m),v.data[y]=m.red,v.data[y+1]=m.green,v.data[y+2]=m.blue,v.data[y+3]=m.alpha}a.putImageData(v,c,l),s=!1}},this.put=function(e,t,n,o,i,u,c){var l=e.getCanvas();if(!(t>=l.width||n>=l.height)&&(t+o>l.width&&(o=l.width-t),n+i>l.height&&(i=l.height-n),0!==o&&0!==i)){r.autosize&&h(u,c,o,i);var d=e.getCanvas().getContext("2d").getImageData(t,n,o,i);a.putImageData(d,u,c),s=!1}},this.copy=function(e,t,n,o,i,u,c){var l=e.getCanvas();t>=l.width||n>=l.height||(t+o>l.width&&(o=l.width-t),n+i>l.height&&(i=l.height-n),0!==o&&0!==i&&(r.autosize&&h(u,c,o,i),a.drawImage(l,t,n,o,i,u,c,o,i),s=!1))},this.moveTo=function(e,t){u&&(a.beginPath(),u=!1),r.autosize&&h(e,t,0,0),a.moveTo(e,t)},this.lineTo=function(e,t){u&&(a.beginPath(),u=!1),r.autosize&&h(e,t,0,0),a.lineTo(e,t)},this.arc=function(e,t,n,o,i,s){u&&(a.beginPath(),u=!1),r.autosize&&h(e,t,0,0),a.arc(e,t,n,o,i,s)},this.curveTo=function(e,t,n,o,i,s){u&&(a.beginPath(),u=!1),r.autosize&&h(i,s,0,0),a.bezierCurveTo(e,t,n,o,i,s)},this.close=function(){a.closePath(),u=!0},this.rect=function(e,t,n,o){u&&(a.beginPath(),u=!1),r.autosize&&h(e,t,n,o),a.rect(e,t,n,o)},this.clip=function(){a.clip(),u=!0},this.strokeColor=function(e,t,n,r,o,i,c){a.lineCap=e,a.lineJoin=t,a.lineWidth=n,a.strokeStyle="rgba("+r+","+o+","+i+","+c/255+")",a.stroke(),s=!1,u=!0},this.fillColor=function(e,t,n,r){a.fillStyle="rgba("+e+","+t+","+n+","+r/255+")",a.fill(),s=!1,u=!0},this.strokeLayer=function(e,t,n,r){a.lineCap=e,a.lineJoin=t,a.lineWidth=n,a.strokeStyle=a.createPattern(r.getCanvas(),"repeat"),a.stroke(),s=!1,u=!0},this.fillLayer=function(e){a.fillStyle=a.createPattern(e.getCanvas(),"repeat"),a.fill(),s=!1,u=!0},this.push=function(){a.save(),c++},this.pop=function(){c>0&&(a.restore(),c--)},this.reset=function(){while(c>0)a.restore(),c--;a.restore(),a.save(),a.beginPath(),u=!1},this.setTransform=function(e,t,n,r,o,i){a.setTransform(e,t,n,r,o,i)},this.transform=function(e,t,n,r,o,i){a.transform(e,t,n,r,o,i)},this.setChannelMask=function(e){a.globalCompositeOperation=l[e]},this.setMiterLimit=function(e){a.miterLimit=e},d(e,t),i.style.zIndex=-1},n.Layer.ROUT=2,n.Layer.ATOP=6,n.Layer.XOR=10,n.Layer.ROVER=11,n.Layer.OVER=14,n.Layer.PLUS=15,n.Layer.RIN=1,n.Layer.IN=4,n.Layer.OUT=8,n.Layer.RATOP=9,n.Layer.SRC=12,n.Layer.Pixel=function(e,t,n,r){this.red=e,this.green=t,this.blue=n,this.alpha=r};n=n||{};n.Mouse=function(e){var t=this;this.touchMouseThreshold=3,this.scrollThreshold=53,this.PIXELS_PER_LINE=18,this.PIXELS_PER_PAGE=16*this.PIXELS_PER_LINE,this.currentState=new n.Mouse.State(0,0,!1,!1,!1,!1,!1),this.onmousedown=null,this.onmouseup=null,this.onmousemove=null,this.onmouseout=null;var r=0,o=0;function i(e){e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function a(){r=t.touchMouseThreshold}function s(e){var n=e.deltaY||-e.wheelDeltaY||-e.wheelDelta;if(n?1===e.deltaMode?n=e.deltaY*t.PIXELS_PER_LINE:2===e.deltaMode&&(n=e.deltaY*t.PIXELS_PER_PAGE):n=e.detail*t.PIXELS_PER_LINE,o+=n,o<=-t.scrollThreshold){do{t.onmousedown&&(t.currentState.up=!0,t.onmousedown(t.currentState)),t.onmouseup&&(t.currentState.up=!1,t.onmouseup(t.currentState)),o+=t.scrollThreshold}while(o<=-t.scrollThreshold);o=0}if(o>=t.scrollThreshold){do{t.onmousedown&&(t.currentState.down=!0,t.onmousedown(t.currentState)),t.onmouseup&&(t.currentState.down=!1,t.onmouseup(t.currentState)),o-=t.scrollThreshold}while(o>=t.scrollThreshold);o=0}i(e)}e.addEventListener("contextmenu",(function(e){i(e)}),!1),e.addEventListener("mousemove",(function(n){i(n),r?r--:(t.currentState.fromClientPosition(e,n.clientX,n.clientY),t.onmousemove&&t.onmousemove(t.currentState))}),!1),e.addEventListener("mousedown",(function(e){if(i(e),!r){switch(e.button){case 0:t.currentState.left=!0;break;case 1:t.currentState.middle=!0;break;case 2:t.currentState.right=!0;break}t.onmousedown&&t.onmousedown(t.currentState)}}),!1),e.addEventListener("mouseup",(function(e){if(i(e),!r){switch(e.button){case 0:t.currentState.left=!1;break;case 1:t.currentState.middle=!1;break;case 2:t.currentState.right=!1;break}t.onmouseup&&t.onmouseup(t.currentState)}}),!1),e.addEventListener("mouseout",(function(n){n||(n=window.event);var r=n.relatedTarget||n.toElement;while(r){if(r===e)return;r=r.parentNode}i(n),(t.currentState.left||t.currentState.middle||t.currentState.right)&&(t.currentState.left=!1,t.currentState.middle=!1,t.currentState.right=!1,t.onmouseup&&t.onmouseup(t.currentState)),t.onmouseout&&t.onmouseout()}),!1),e.addEventListener("selectstart",(function(e){i(e)}),!1),e.addEventListener("touchmove",a,!1),e.addEventListener("touchstart",a,!1),e.addEventListener("touchend",a,!1),e.addEventListener("DOMMouseScroll",s,!1),e.addEventListener("mousewheel",s,!1),e.addEventListener("wheel",s,!1);var u=function(){var e=document.createElement("div");if(!("cursor"in e.style))return!1;try{e.style.cursor="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX///+nxBvIAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==) 0 0, auto"}catch(t){return!1}return/\burl\([^()]*\)\s+0\s+0\b/.test(e.style.cursor||"")}();this.setCursor=function(t,n,r){if(u){var o=t.toDataURL("image/png");return e.style.cursor="url("+o+") "+n+" "+r+", auto",!0}return!1}},n.Mouse.State=function(e,t,n,r,o,i,a){var s=this;this.x=e,this.y=t,this.left=n,this.middle=r,this.right=o,this.up=i,this.down=a,this.fromClientPosition=function(e,t,n){s.x=t-e.offsetLeft,s.y=n-e.offsetTop;var r=e.offsetParent;while(r&&r!==document.body)s.x-=r.offsetLeft-r.scrollLeft,s.y-=r.offsetTop-r.scrollTop,r=r.offsetParent;if(r){var o=document.body.scrollLeft||document.documentElement.scrollLeft,i=document.body.scrollTop||document.documentElement.scrollTop;s.x-=r.offsetLeft-o,s.y-=r.offsetTop-i}}},n.Mouse.Touchpad=function(e){var t=this;this.scrollThreshold=20*(window.devicePixelRatio||1),this.clickTimingThreshold=250,this.clickMoveThreshold=10*(window.devicePixelRatio||1),this.currentState=new n.Mouse.State(0,0,!1,!1,!1,!1,!1),this.onmousedown=null,this.onmouseup=null,this.onmousemove=null;var r=0,o=0,i=0,a=0,s=0,u={1:"left",2:"right",3:"middle"},c=!1,l=null;e.addEventListener("touchend",(function(e){if(e.preventDefault(),c&&0===e.touches.length){var n=(new Date).getTime(),o=u[r];t.currentState[o]&&(t.currentState[o]=!1,t.onmouseup&&t.onmouseup(t.currentState),l&&(window.clearTimeout(l),l=null)),n-a<=t.clickTimingThreshold&&s<t.clickMoveThreshold&&(t.currentState[o]=!0,t.onmousedown&&t.onmousedown(t.currentState),l=window.setTimeout((function(){t.currentState[o]=!1,t.onmouseup&&t.onmouseup(t.currentState),c=!1}),t.clickTimingThreshold)),l||(c=!1)}}),!1),e.addEventListener("touchstart",(function(e){if(e.preventDefault(),r=Math.min(e.touches.length,3),l&&(window.clearTimeout(l),l=null),!c){c=!0;var t=e.touches[0];o=t.clientX,i=t.clientY,a=(new Date).getTime(),s=0}}),!1),e.addEventListener("touchmove",(function(n){n.preventDefault();var u=n.touches[0],c=u.clientX-o,l=u.clientY-i;if(s+=Math.abs(c)+Math.abs(l),1===r){var d=s/((new Date).getTime()-a),h=1+d;t.currentState.x+=c*h,t.currentState.y+=l*h,t.currentState.x<0?t.currentState.x=0:t.currentState.x>=e.offsetWidth&&(t.currentState.x=e.offsetWidth-1),t.currentState.y<0?t.currentState.y=0:t.currentState.y>=e.offsetHeight&&(t.currentState.y=e.offsetHeight-1),t.onmousemove&&t.onmousemove(t.currentState),o=u.clientX,i=u.clientY}else if(2===r){var f;if(Math.abs(l)>=t.scrollThreshold)f=l>0?"down":"up",t.currentState[f]=!0,t.onmousedown&&t.onmousedown(t.currentState),t.currentState[f]=!1,t.onmouseup&&t.onmouseup(t.currentState),o=u.clientX,i=u.clientY}}),!1)},n.Mouse.Touchscreen=function(e){var t=this,r=!1,o=null,i=null,a=null,s=null;function u(e){t.currentState[e]||(t.currentState[e]=!0,t.onmousedown&&t.onmousedown(t.currentState))}function c(e){t.currentState[e]&&(t.currentState[e]=!1,t.onmouseup&&t.onmouseup(t.currentState))}function l(e){u(e),c(e)}function d(n,r){t.currentState.fromClientPosition(e,n,r),t.onmousemove&&t.onmousemove(t.currentState)}function h(e){var n=e.touches[0]||e.changedTouches[0],r=n.clientX-o,a=n.clientY-i;return Math.sqrt(r*r+a*a)>=t.clickMoveThreshold}function f(e){var t=e.touches[0];r=!0,o=t.clientX,i=t.clientY}function p(){window.clearTimeout(a),window.clearTimeout(s),r=!1}this.scrollThreshold=20*(window.devicePixelRatio||1),this.clickTimingThreshold=250,this.clickMoveThreshold=16*(window.devicePixelRatio||1),this.longPressThreshold=500,this.currentState=new n.Mouse.State(0,0,!1,!1,!1,!1,!1),this.onmousedown=null,this.onmouseup=null,this.onmousemove=null,e.addEventListener("touchend",(function(e){if(r)if(0===e.touches.length&&1===e.changedTouches.length){if(window.clearTimeout(s),c("left"),!h(e)&&(e.preventDefault(),!t.currentState.left)){var n=e.changedTouches[0];d(n.clientX,n.clientY),u("left"),a=window.setTimeout((function(){c("left"),p()}),t.clickTimingThreshold)}}else p()}),!1),e.addEventListener("touchstart",(function(e){1===e.touches.length?(e.preventDefault(),f(e),window.clearTimeout(a),s=window.setTimeout((function(){var t=e.touches[0];d(t.clientX,t.clientY),l("right"),p()}),t.longPressThreshold)):p()}),!1),e.addEventListener("touchmove",(function(e){if(r)if(h(e)&&window.clearTimeout(s),1===e.touches.length){if(t.currentState.left){e.preventDefault();var n=e.touches[0];d(n.clientX,n.clientY)}}else p()}),!1)};n=n||{},n=n||{};n.Object=function(e,t){var n=this,r={},o=function(e){var t=r[e];if(!t)return null;var n=t.shift();return 0===t.length&&delete r[e],n},i=function(e,t){var n=r[e];n||(n=[],r[e]=n),n.push(t)};this.index=t,this.onbody=function(e,t,n){var r=o(n);r&&r(e,t)},this.onundefine=null,this.requestInputStream=function(t,r){r&&i(t,r),e.requestObjectInputStream(n.index,t)},this.createOutputStream=function(t,r){return e.createObjectOutputStream(n.index,t,r)}},n.Object.ROOT_STREAM="/",n.Object.STREAM_INDEX_MIMETYPE="application/vnd.glyptodon.guacamole.stream-index+json";n=n||{};n.OnScreenKeyboard=function(e){var t=this,r={},o={},i=[],a=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},s=function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(/([^ ]+)[ ]*/g,(function(e,n){return n===t?"":e}))},u=0,c=function(e,t,n,r){this.width=t,this.height=n,this.scale=function(o){e.style.width=t*o+"px",e.style.height=n*o+"px",r&&(e.style.lineHeight=n*o+"px",e.style.fontSize=o+"px")}},l=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(!(n in r))return!1}return!0},d=function(e){var n=t.keys[e];if(!n)return null;for(var r=n.length-1;r>=0;r--){var o=n[r];if(l(o.requires))return o}return null},h=function(e,n){if(!o[e]){a(n,"guac-keyboard-pressed");var i=d(e);if(i.modifier){var u="guac-keyboard-modifier-"+g(i.modifier),c=r[i.modifier];c?(s(p,u),delete r[i.modifier],t.onkeyup&&t.onkeyup(c)):(a(p,u),r[i.modifier]=i.keysym,t.onkeydown&&t.onkeydown(i.keysym))}else t.onkeydown&&t.onkeydown(i.keysym);o[e]=!0}},f=function(e,n){if(o[e]){s(n,"guac-keyboard-pressed");var r=d(e);!r.modifier&&t.onkeyup&&t.onkeyup(r.keysym),o[e]=!1}},p=document.createElement("div");p.className="guac-keyboard",p.onselectstart=p.onmousemove=p.onmouseup=p.onmousedown=function(e){return u&&u--,e.stopPropagation(),!1},this.touchMouseThreshold=3,this.onkeydown=null,this.onkeyup=null,this.layout=new n.OnScreenKeyboard.Layout(e),this.getElement=function(){return p},this.resize=function(e){for(var n=Math.floor(10*e/t.layout.width)/10,r=0;r<i.length;r++){var o=i[r];o.scale(n)}};var v=function(e,t){if(t instanceof Array){for(var r=[],o=0;o<t.length;o++)r.push(new n.OnScreenKeyboard.Key(t[o],e));return r}return"number"===typeof t?[new n.OnScreenKeyboard.Key({name:e,keysym:t})]:"string"===typeof t?[new n.OnScreenKeyboard.Key({name:e,title:t})]:[new n.OnScreenKeyboard.Key(t,e)]},y=function(t){var n={};for(var r in e.keys)n[r]=v(r,t[r]);return n};this.keys=y(e.keys);var g=function(e){var t=e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[^A-Za-z0-9]+/g,"-").toLowerCase();return t},m=function e(n,r,o){var s,l=document.createElement("div");if(o&&a(l,"guac-keyboard-"+g(o)),r instanceof Array)for(a(l,"guac-keyboard-group"),s=0;s<r.length;s++)e(l,r[s]);else if(r instanceof Object){a(l,"guac-keyboard-group");var d=Object.keys(r).sort();for(s=0;s<d.length;s++){o=d[s];e(l,r[o],o)}}else if("number"===typeof r)a(l,"guac-keyboard-gap"),i.push(new c(l,r,r));else if("string"===typeof r){var p=r;1===p.length&&(p="0x"+p.charCodeAt(0).toString(16)),a(l,"guac-keyboard-key-container");var v=document.createElement("div");v.className="guac-keyboard-key guac-keyboard-key-"+g(p);var y=t.keys[r];if(y)for(s=0;s<y.length;s++){var m=y[s],w=document.createElement("div");w.className="guac-keyboard-cap",w.textContent=m.title;for(var S=0;S<m.requires.length;S++){var b=m.requires[S];a(w,"guac-keyboard-requires-"+g(b)),a(v,"guac-keyboard-uses-"+g(b))}v.appendChild(w)}l.appendChild(v),i.push(new c(l,t.layout.keyWidths[r]||1,1,!0));var E=function(e){e.preventDefault(),u=t.touchMouseThreshold,h(r,v)},T=function(e){e.preventDefault(),u=t.touchMouseThreshold,f(r,v)},I=function(e){e.preventDefault(),0===u&&h(r,v)},C=function(e){e.preventDefault(),0===u&&f(r,v)};v.addEventListener("touchstart",E,!0),v.addEventListener("touchend",T,!0),v.addEventListener("mousedown",I,!0),v.addEventListener("mouseup",C,!0),v.addEventListener("mouseout",C,!0)}n.appendChild(l)};m(p,e.layout)},n.OnScreenKeyboard.Layout=function(e){this.language=e.language,this.type=e.type,this.keys=e.keys,this.layout=e.layout,this.width=e.width,this.keyWidths=e.keyWidths||{}},n.OnScreenKeyboard.Key=function(e,t){this.name=t||e.name,this.title=e.title||this.name,this.keysym=e.keysym||function(e){if(!e||1!==e.length)return null;var t=e.charCodeAt(0);return t>=0&&t<=255?t:t>=256&&t<=1114111?16777216|t:null}(this.title),this.modifier=e.modifier,this.requires=e.requires||[]};n=n||{};n.OutputStream=function(e,t){var n=this;this.index=t,this.onack=null,this.sendBlob=function(t){e.sendBlob(n.index,t)},this.sendEnd=function(){e.endStream(n.index)}};n=n||{};n.Parser=function(){var e=this,t="",n=[],r=-1,o=0;this.receive=function(i){o>4096&&r>=o&&(t=t.substring(o),r-=o,o=0),t+=i;while(r<t.length){if(r>=o){var a=t.substring(o,r),s=t.substring(r,r+1);if(n.push(a),";"==s){var u=n.shift();null!=e.oninstruction&&e.oninstruction(u,n),n.length=0}else if(","!=s)throw new Error("Illegal terminator.");o=r+1}var c=t.indexOf(".",o);if(-1==c){o=t.length;break}var l=parseInt(t.substring(r+1,c));if(isNaN(l))throw new Error("Non-numeric character in element length.");o=c+1,r=o+l}},this.oninstruction=null};n=n||{};n.RawAudioFormat=function(e){this.bytesPerSample=e.bytesPerSample,this.channels=e.channels,this.rate=e.rate},n.RawAudioFormat.parse=function(e){var t,r=null,o=1;if("audio/L8;"===e.substring(0,9))e=e.substring(9),t=1;else{if("audio/L16;"!==e.substring(0,10))return null;e=e.substring(10),t=2}for(var i=e.split(","),a=0;a<i.length;a++){var s=i[a],u=s.indexOf("=");if(-1===u)return null;var c=s.substring(0,u),l=s.substring(u+1);switch(c){case"channels":o=parseInt(l);break;case"rate":r=parseInt(l);break;default:return null}}return null===r?null:new n.RawAudioFormat({bytesPerSample:t,channels:o,rate:r})};n=n||{};n.SessionRecording=function(e){var t=this,r=16384,o=5e3,i=5,a=[],s=[],u=0,c=0,l=new n.SessionRecording._PlaybackTunnel,d=new n.Client(l),h=-1,f=null,p=null,v=null;d.connect(),d.getDisplay().showCursor(!1),e.oninstruction=function(e,i){var l=new n.SessionRecording._Frame.Instruction(e,i.slice());if(s.push(l),u+=l.getSize(),"sync"===e){var d=parseInt(i[0]),h=new n.SessionRecording._Frame(d,s);a.push(h),(1===a.length||u>=r&&d-c>=o)&&(h.keyframe=!0,c=d,u=0),s=[],t.onprogress&&t.onprogress(t.getDuration())}};var y=function(e){return 0===a.length?0:e-a[0].timestamp},g=function e(t,n,r){if(t===n)return t;var o=Math.floor((t+n)/2),i=y(a[o].timestamp);return r<i&&o>t?e(t,o-1,r):r>i&&o<n?e(o+1,n,r):o},m=function(e){for(var t=a[e],n=0;n<t.instructions.length;n++){var r=t.instructions[n];l.receiveInstruction(r.opcode,r.args)}t.keyframe&&!t.clientState&&d.exportState((function(e){t.clientState=e}))},w=function e(n,r,o){S(),v=window.setTimeout((function(){var s;for(s=n;s>=0;s--){var u=a[s];if(s===h)break;if(u.clientState){d.importState(u.clientState);break}}s++;for(var c=(new Date).getTime();s<=n;s++){var l=(new Date).getTime();if(l-c>=i)break;m(s)}h=s-1,t.onseek&&t.onseek(t.getPosition()),h!==n?e(n,r,Math.max(o-((new Date).getTime()-c),0)):r()}),o||0)},S=function(){window.clearTimeout(v)},b=function e(){if(h+1<a.length){var n=a[h+1],r=n.timestamp-f+p,o=Math.max(r-(new Date).getTime(),0);w(h+1,(function(){e()}),o)}else t.pause()};this.onprogress=null,this.onplay=null,this.onpause=null,this.onseek=null,this.connect=function(t){e.connect(t)},this.disconnect=function(){e.disconnect()},this.getDisplay=function(){return d.getDisplay()},this.isPlaying=function(){return!!f},this.getPosition=function(){return-1===h?0:y(a[h].timestamp)},this.getDuration=function(){return 0===a.length?0:y(a[a.length-1].timestamp)},this.play=function(){if(!t.isPlaying()&&h+1<a.length){t.onplay&&t.onplay();var e=a[h+1];f=e.timestamp,p=(new Date).getTime(),b()}},this.seek=function(e,n){if(0!==a.length){var r=t.isPlaying();t.pause(),w(g(0,a.length-1,e),(function(){r&&t.play(),n&&n()}))}},this.pause=function(){S(),t.isPlaying()&&(t.onpause&&t.onpause(),f=null,p=null)}},n.SessionRecording._Frame=function(e,t){this.keyframe=!1,this.timestamp=e,this.instructions=t,this.clientState=null},n.SessionRecording._Frame.Instruction=function(e,t){var n=this;this.opcode=e,this.args=t,this.getSize=function(){for(var e=n.opcode.length,t=0;t<n.args.length;t++)e+=n.args[t].length;return e}},n.SessionRecording._PlaybackTunnel=function(){var e=this;this.connect=function(e){},this.sendMessage=function(e){},this.disconnect=function(){},this.receiveInstruction=function(t,n){e.oninstruction&&e.oninstruction(t,n)}};n=n||{};n.Status=function(e,t){var n=this;this.code=e,this.message=t,this.isError=function(){return n.code<0||n.code>255}},n.Status.Code={SUCCESS:0,UNSUPPORTED:256,SERVER_ERROR:512,SERVER_BUSY:513,UPSTREAM_TIMEOUT:514,UPSTREAM_ERROR:515,RESOURCE_NOT_FOUND:516,RESOURCE_CONFLICT:517,RESOURCE_CLOSED:518,UPSTREAM_NOT_FOUND:519,UPSTREAM_UNAVAILABLE:520,SESSION_CONFLICT:521,SESSION_TIMEOUT:522,SESSION_CLOSED:523,CLIENT_BAD_REQUEST:768,CLIENT_UNAUTHORIZED:769,CLIENT_FORBIDDEN:771,CLIENT_TIMEOUT:776,CLIENT_OVERRUN:781,CLIENT_BAD_TYPE:783,CLIENT_TOO_MANY:797},n.Status.Code.fromHTTPCode=function(e){switch(e){case 400:return n.Status.Code.CLIENT_BAD_REQUEST;case 403:return n.Status.Code.CLIENT_FORBIDDEN;case 404:return n.Status.Code.RESOURCE_NOT_FOUND;case 429:return n.Status.Code.CLIENT_TOO_MANY;case 503:return n.Status.Code.SERVER_BUSY}return n.Status.Code.SERVER_ERROR},n.Status.Code.fromWebSocketCode=function(e){switch(e){case 1e3:return n.Status.Code.SUCCESS;case 1006:case 1015:return n.Status.Code.UPSTREAM_NOT_FOUND;case 1001:case 1012:case 1013:case 1014:return n.Status.Code.UPSTREAM_UNAVAILABLE}return n.Status.Code.SERVER_ERROR};n=n||{};n.StringReader=function(e){var t=this,r=new n.ArrayBufferReader(e),o=0,i=0;function a(e){for(var t="",n=new Uint8Array(e),r=0;r<n.length;r++){var a=n[r];0===o?127===(127|a)?t+=String.fromCharCode(a):223===(31|a)?(i=31&a,o=1):239===(15|a)?(i=15&a,o=2):247===(7|a)?(i=7&a,o=3):t+="":191===(63|a)?(i=i<<6|63&a,o--,0===o&&(t+=String.fromCharCode(i))):(o=0,t+="")}return t}r.ondata=function(e){var n=a(e);t.ontext&&t.ontext(n)},r.onend=function(){t.onend&&t.onend()},this.ontext=null,this.onend=null};n=n||{};n.StringWriter=function(e){var t=this,r=new n.ArrayBufferWriter(e),o=new Uint8Array(8192),i=0;function a(e){if(i+e>=o.length){var t=new Uint8Array(2*(i+e));t.set(o),o=t}i+=e}function s(e){var t,n;if(e<=127)t=0,n=1;else if(e<=2047)t=192,n=2;else if(e<=65535)t=224,n=3;else{if(!(e<=2097151))return void s(65533);t=240,n=4}a(n);for(var r=i-1,u=1;u<n;u++)o[r--]=128|63&e,e>>=6;o[r]=t|e}function u(e){for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);s(n)}if(i>0){var r=o.subarray(0,i);return i=0,r}}r.onack=function(e){t.onack&&t.onack(e)},this.sendText=function(e){e.length&&r.sendData(u(e))},this.sendEnd=function(){r.sendEnd()},this.onack=null};n=n||{};n.Tunnel=function(){this.connect=function(e){},this.disconnect=function(){},this.sendMessage=function(e){},this.setState=function(e){e!==this.state&&(this.state=e,this.onstatechange&&this.onstatechange(e))},this.setUUID=function(e){this.uuid=e,this.onuuid&&this.onuuid(e)},this.isConnected=function(){return this.state===n.Tunnel.State.OPEN||this.state===n.Tunnel.State.UNSTABLE},this.state=n.Tunnel.State.CONNECTING,this.receiveTimeout=15e3,this.unstableThreshold=1500,this.uuid=null,this.onuuid=null,this.onerror=null,this.onstatechange=null,this.oninstruction=null},n.Tunnel.INTERNAL_DATA_OPCODE="",n.Tunnel.State={CONNECTING:0,OPEN:1,CLOSED:2,UNSTABLE:3},n.HTTPTunnel=function(e,t,r){var o=this,i=e+"?connect",a=e+"?read:",s=e+"?write:",u=1,c=0,l=u,d=!1,h="",f=!!t,p=null,v=null,y=null,g=500,m=r||{};function w(e,t){for(var n in t)e.setRequestHeader(n,t[n])}function S(){window.clearTimeout(p),window.clearTimeout(v),o.state===n.Tunnel.State.UNSTABLE&&o.setState(n.Tunnel.State.OPEN),p=window.setTimeout((function(){b(new n.Status(n.Status.Code.UPSTREAM_TIMEOUT,"Server timeout."))}),o.receiveTimeout),v=window.setTimeout((function(){o.setState(n.Tunnel.State.UNSTABLE)}),o.unstableThreshold)}function b(e){window.clearTimeout(p),window.clearTimeout(v),window.clearInterval(y),o.state!==n.Tunnel.State.CLOSED&&(e.code!==n.Status.Code.SUCCESS&&o.onerror&&(o.state!==n.Tunnel.State.CONNECTING&&e.code===n.Status.Code.RESOURCE_NOT_FOUND||o.onerror(e)),d=!1,o.setState(n.Tunnel.State.CLOSED))}function E(){if(o.isConnected())if(h.length>0){d=!0;var e=new XMLHttpRequest;e.open("POST",s+o.uuid),e.withCredentials=f,w(e,m),e.setRequestHeader("Content-type","application/octet-stream"),e.onreadystatechange=function(){4===e.readyState&&(S(),200!==e.status?T(e):E())},e.send(h),h=""}else d=!1}function T(e){var t=parseInt(e.getResponseHeader("Guacamole-Status-Code"));if(t){var r=e.getResponseHeader("Guacamole-Error-Message");b(new n.Status(t,r))}else e.status?b(new n.Status(n.Status.Code.fromHTTPCode(e.status),e.statusText)):b(new n.Status(n.Status.Code.UPSTREAM_NOT_FOUND))}function I(e){var t=null,n=null,r=0,i=-1,a=0,s=new Array;function d(){if(o.isConnected()){if(!(e.readyState<2)){var r;try{r=e.status}catch(g){r=200}if(n||200!==r||(n=k()),3===e.readyState||4===e.readyState){if(S(),l===u&&(3!==e.readyState||t?4===e.readyState&&t&&clearInterval(t):t=setInterval(d,30)),0===e.status)return void o.disconnect();if(200!==e.status)return void T(e);var c;try{c=e.responseText}catch(g){return}while(i<c.length){if(i>=a){var h=c.substring(a,i),f=c.substring(i,i+1);if(s.push(h),";"===f){var p=s.shift();o.oninstruction&&o.oninstruction(p,s),s.length=0}a=i+1}var v=c.indexOf(".",a);if(-1===v){a=c.length;break}var y=parseInt(c.substring(i+1,v));if(0===y){t&&clearInterval(t),e.onreadystatechange=null,e.abort(),n&&I(n);break}a=v+1,i=a+y}}}}else null!==t&&clearInterval(t)}e.onreadystatechange=l===u?function(){3===e.readyState&&(r++,r>=2&&(l=c,e.onreadystatechange=d)),d()}:d,d()}this.sendMessage=function(){if(o.isConnected()&&0!==arguments.length){for(var e=n(arguments[0]),t=1;t<arguments.length;t++)e+=","+n(arguments[t]);e+=";",h+=e,d||E()}function n(e){var t=new String(e);return t.length+"."+t}};var C=0;function k(){var e=new XMLHttpRequest;return e.open("GET",a+o.uuid+":"+C++),e.withCredentials=f,w(e,m),e.send(null),e}this.connect=function(e){S(),o.setState(n.Tunnel.State.CONNECTING);var t=new XMLHttpRequest;t.onreadystatechange=function(){4===t.readyState&&(200===t.status?(S(),o.setUUID(t.responseText),o.setState(n.Tunnel.State.OPEN),y=setInterval((function(){o.sendMessage("nop")}),g),I(k())):T(t))},t.open("POST",i,!0),t.withCredentials=f,w(t,m),t.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),t.send(e)},this.disconnect=function(){b(new n.Status(n.Status.Code.SUCCESS,"Manually closed."))}},n.HTTPTunnel.prototype=new n.Tunnel,n.WebSocketTunnel=function(e){var t=this,r=null,o=null,i=null,a=null,s={"http:":"ws:","https:":"wss:"},u=500;if("ws:"!==e.substring(0,3)&&"wss:"!==e.substring(0,4)){var c=s[window.location.protocol];if("/"===e.substring(0,1))e=c+"//"+window.location.host+e;else{var l=window.location.pathname.lastIndexOf("/"),d=window.location.pathname.substring(0,l+1);e=c+"//"+window.location.host+d+e}}function h(){window.clearTimeout(o),window.clearTimeout(i),t.state===n.Tunnel.State.UNSTABLE&&t.setState(n.Tunnel.State.OPEN),o=window.setTimeout((function(){f(new n.Status(n.Status.Code.UPSTREAM_TIMEOUT,"Server timeout."))}),t.receiveTimeout),i=window.setTimeout((function(){t.setState(n.Tunnel.State.UNSTABLE)}),t.unstableThreshold)}function f(e){window.clearTimeout(o),window.clearTimeout(i),window.clearInterval(a),t.state!==n.Tunnel.State.CLOSED&&(e.code!==n.Status.Code.SUCCESS&&t.onerror&&t.onerror(e),t.setState(n.Tunnel.State.CLOSED),r.close())}this.sendMessage=function(e){if(t.isConnected()&&0!==arguments.length){for(var n=i(arguments[0]),o=1;o<arguments.length;o++)n+=","+i(arguments[o]);n+=";",r.send(n)}function i(e){var t=new String(e);return t.length+"."+t}},this.connect=function(o){h(),t.setState(n.Tunnel.State.CONNECTING),r=new WebSocket(e+"?"+o,"guacamole"),r.onopen=function(e){h(),a=setInterval((function(){t.sendMessage(n.Tunnel.INTERNAL_DATA_OPCODE,"ping",(new Date).getTime())}),u)},r.onclose=function(e){e.reason?f(new n.Status(parseInt(e.reason),e.reason)):e.code?f(new n.Status(n.Status.Code.fromWebSocketCode(e.code))):f(new n.Status(n.Status.Code.UPSTREAM_NOT_FOUND))},r.onmessage=function(e){h();var r,o=e.data,i=0,a=[];do{var s=o.indexOf(".",i);if(-1!==s){var u=parseInt(o.substring(r+1,s));i=s+1,r=i+u}else f(new n.Status(n.Status.Code.SERVER_ERROR,"Incomplete instruction."));var c=o.substring(i,r),l=o.substring(r,r+1);if(a.push(c),";"===l){var d=a.shift();null===t.uuid&&(d===n.Tunnel.INTERNAL_DATA_OPCODE&&t.setUUID(a[0]),t.setState(n.Tunnel.State.OPEN)),d!==n.Tunnel.INTERNAL_DATA_OPCODE&&t.oninstruction&&t.oninstruction(d,a),a.length=0}i=r+1}while(i<o.length)}},this.disconnect=function(){f(new n.Status(n.Status.Code.SUCCESS,"Manually closed."))}},n.WebSocketTunnel.prototype=new n.Tunnel,n.ChainedTunnel=function(e){for(var t,r=this,o=[],i=null,a=0;a<arguments.length;a++)o.push(arguments[a]);function s(e){r.disconnect=e.disconnect,r.sendMessage=e.sendMessage;var a=function(t){if(t&&t.code===n.Status.Code.UPSTREAM_TIMEOUT)return o=[],null;var r=o.shift();return r&&(e.onerror=null,e.oninstruction=null,e.onstatechange=null,s(r)),r};function u(){e.onstatechange=r.onstatechange,e.oninstruction=r.oninstruction,e.onerror=r.onerror,e.onuuid=r.onuuid,e.uuid&&r.setUUID(e.uuid),i=e}e.onstatechange=function(e){switch(e){case n.Tunnel.State.OPEN:u(),r.onstatechange&&r.onstatechange(e);break;case n.Tunnel.State.CLOSED:!a()&&r.onstatechange&&r.onstatechange(e);break}},e.oninstruction=function(e,t){u(),r.oninstruction&&r.oninstruction(e,t)},e.onerror=function(e){!a(e)&&r.onerror&&r.onerror(e)},e.connect(t)}this.connect=function(e){t=e;var a=i||o.shift();a?s(a):r.onerror&&r.onerror(n.Status.Code.SERVER_ERROR,"No tunnels to try.")}},n.ChainedTunnel.prototype=new n.Tunnel,n.StaticHTTPTunnel=function(e,t,r){var o=this,i=null,a=r||{};function s(e,t){for(var n in t)e.setRequestHeader(n,t[n])}this.sendMessage=function(e){},this.connect=function(r){o.disconnect(),o.setState(n.Tunnel.State.CONNECTING),i=new XMLHttpRequest,i.open("GET",e),i.withCredentials=!!t,s(i,a),i.responseType="text",i.send(null);var u=0,c=new n.Parser;c.oninstruction=function(e,t){o.oninstruction&&o.oninstruction(e,t)},i.onreadystatechange=function(){if(3===i.readyState||4===i.readyState){o.setState(n.Tunnel.State.OPEN);var e=i.responseText,t=e.length;u<t&&(c.receive(e.substring(u)),u=t)}4===i.readyState&&o.disconnect()},i.onerror=function(){o.onerror&&o.onerror(new n.Status(n.Status.Code.fromHTTPCode(i.status),i.statusText)),o.disconnect()}},this.disconnect=function(){i&&(i.abort(),i=null),o.setState(n.Tunnel.State.CLOSED)}},n.StaticHTTPTunnel.prototype=new n.Tunnel;n=n||{};n.API_VERSION="1.3.0";n=n||{};n.VideoPlayer=function(){this.sync=function(){}},n.VideoPlayer.isSupportedType=function(e){return!1},n.VideoPlayer.getSupportedTypes=function(){return[]},n.VideoPlayer.getInstance=function(e,t,n){return null},e.exports=n},b0c0:function(e,t,n){var r=n("83ab"),o=n("9bf2").f,i=Function.prototype,a=i.toString,s=/^\s*function ([^ (]*)/,u="name";r&&!(u in i)&&o(i,u,{configurable:!0,get:function(){try{return a.call(this).match(s)[1]}catch(e){return""}}})},dd30:function(e,t,n){"use strict";n("3d6c")},fb6a:function(e,t,n){"use strict";var r=n("23e7"),o=n("861d"),i=n("e8b5"),a=n("23cb"),s=n("50c4"),u=n("fc6a"),c=n("8418"),l=n("b622"),d=n("1dde"),h=d("slice"),f=l("species"),p=[].slice,v=Math.max;r({target:"Array",proto:!0,forced:!h},{slice:function(e,t){var n,r,l,d=u(this),h=s(d.length),y=a(e,h),g=a(void 0===t?h:t,h);if(i(d)&&(n=d.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)?o(n)&&(n=n[f],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return p.call(d,y,g);for(r=new(void 0===n?Array:n)(v(g-y,0)),l=0;y<g;y++,l++)y in d&&c(r,l,d[y]);return r.length=l,r}})}}]);
//# sourceMappingURL=chunk-6ce7f546.c3b7f621.js.map